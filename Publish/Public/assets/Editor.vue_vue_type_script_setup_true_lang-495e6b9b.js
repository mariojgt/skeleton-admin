import{A as b,x as O,bo as x,a as V,aN as D,p as U,aS as F,aQ as K,aU as R,h as _,bO as N,o as T,g as k,e as z,u as S,i as G,I as H,Q}from"./preset-dc82439c.js";var q=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],W=function(e){return q.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},J=function(e,t,n){Object.keys(t).filter(W).forEach(function(i){var a=t[i];typeof a=="function"&&(i==="onInit"?a(e,n):n.on(i.substring(2),function(l){return a(l,n)}))})},X=function(e,t,n,i){var a=e.modelEvents?e.modelEvents:null,l=Array.isArray(a)?a.join(" "):a;b(i,function(u,r){n&&typeof u=="string"&&u!==r&&u!==n.getContent({format:e.outputFormat})&&n.setContent(u)}),n.on(l||"change input undo redo",function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},Y=function(e,t,n,i,a,l){i.setContent(l()),n.attrs["onUpdate:modelValue"]&&X(t,n,i,a),J(e,n.attrs,i)},M=0,B=function(e){var t=Date.now(),n=Math.floor(Math.random()*1e9);return M++,e+"_"+n+M+String(t)},Z=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},A=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},$=function(e,t){return A(e).concat(A(t))},ee=function(e){return e==null},I=function(){return{listeners:[],scriptId:B("tiny-script"),scriptLoaded:!1}},ne=function(){var e=I(),t=function(a,l,u,r){var o=l.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=a,o.src=u;var c=function(){o.removeEventListener("load",c),r()};o.addEventListener("load",c),l.head&&l.head.appendChild(o)},n=function(a,l,u){e.scriptLoaded?u():(e.listeners.push(u),a.getElementById(e.scriptId)||t(e.scriptId,a,l,function(){e.listeners.forEach(function(r){return r()}),e.scriptLoaded=!0}))},i=function(){e=I()};return{load:n,reinitialize:i}},te=ne(),oe=function(){return typeof window<"u"?window:global},g=function(){var e=oe();return e&&e.tinymce?e.tinymce:null},ae={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},v=globalThis&&globalThis.__assign||function(){return v=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},v.apply(this,arguments)},re=function(e,t,n,i){return e(i||"div",{id:t,ref:n})},ie=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},w={selector:void 0,target:void 0},le=O({props:ae,setup:function(e,t){var n=e.init?v(v({},e.init),w):v({},w),i=x(e),a=i.disabled,l=i.modelValue,u=i.tagName,r=V(null),o=null,c=e.id||B("tiny-vue"),m=e.init&&e.init.inline||e.inline,f=!!t.attrs["onUpdate:modelValue"],y=!0,p=e.initialValue?e.initialValue:"",E="",P=function(d){return f?function(){return l!=null&&l.value?l.value:""}:function(){return d?p:E}},C=function(){var d=P(y),s=v(v({},n),{readonly:e.disabled,target:r.value,plugins:$(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:m,setup:function(h){o=h,h.on("init",function(L){return Y(L,e,t,h,l,d)}),typeof n.setup=="function"&&n.setup(h)}});Z(r.value)&&(r.value.style.visibility=""),g().init(s),y=!1};b(a,function(d){var s;o!==null&&(typeof((s=o.mode)===null||s===void 0?void 0:s.set)=="function"?o.mode.set(d?"readonly":"design"):o.setMode(d?"readonly":"design"))}),b(u,function(d){var s;f||(E=o.getContent()),(s=g())===null||s===void 0||s.remove(o),D(function(){return C()})}),U(function(){if(g()!==null)C();else if(r.value&&r.value.ownerDocument){var d=e.cloudChannel?e.cloudChannel:"6",s=e.apiKey?e.apiKey:"no-api-key",h=ee(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(s,"/tinymce/").concat(d,"/tinymce.min.js"):e.tinymceScriptSrc;te.load(r.value.ownerDocument,h,C)}}),F(function(){g()!==null&&g().remove(o)}),m||(K(function(){y||C()}),R(function(){var d;f||(E=o.getContent()),(d=g())===null||d===void 0||d.remove(o)}));var j=function(d){var s;E=o.getContent(),(s=g())===null||s===void 0||s.remove(o),n=v(v(v({},n),d),w),D(function(){return C()})};return t.expose({rerender:j,getEditor:function(){return o}}),function(){return m?re(_,c,r,e.tagName):ie(_,c,r)}}}),ue=typeof self=="object"?self.FormData:window.FormData;const de=N(ue),ce=O({__name:"Editor",props:{modelValue:{type:String,default:""},apiKey:{type:String,default:null},editModelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=t;let a=null;const l=c=>{a=c.editor,a.on("change",m=>{u()})},u=()=>{i("update:modelValue",r.value)};let r=V(null),o=V(!1);return U(()=>{r.value=n.modelValue,o.value=!0}),b(()=>r.value,c=>{o.value&&u()}),b(()=>n.editModelValue,c=>{r.value=c,u()}),(c,m)=>(T(),k("div",null,[z(S(le),{modelValue:S(r),"onUpdate:modelValue":m[0]||(m[0]=f=>G(r)?r.value=f:r=f),"api-key":n.apiKey,init:{plugins:"lists link image table code help wordcount codesample importcss",toolbar:"undo redo | image code | codesample",content_css:"/my-styles.css",setup:f=>l({editor:f}),images_upload_handler:async f=>{let y=new(S(de));y.append("file",f.blob(),f.filename());try{const p=await S(H).post(S(Q)().props.upload_media,y,{headers:{"Content-Type":"multipart/form-data"}});if(p.data&&p.data.data.url.default)return p.data.data.url.default;throw new Error("Unable to upload image")}catch{throw new Error("Unable to upload image")}}}},null,8,["modelValue","api-key","init"])]))}});export{ce as _};
