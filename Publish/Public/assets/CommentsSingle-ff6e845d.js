import{v as J,bZ as K,a as g,m as se,o,g as n,d as e,e as d,u as r,x as $,f as U,k as A,D as H,E as z,i as _,t as j,s as f,z as p,q as Z,F as re,y as oe,b as W,X as le}from"./preset-b90b9b08.js";import{a as F}from"./axios-0c773085.js";import{M as Q}from"./message-circle-78d7a2a9.js";import{X as Y}from"./x-b0b4ae59.js";import{C as ne,I as ae}from"./info-b159d59c.js";import{S as ie}from"./send-01c9abcb.js";import{T as de,M as me}from"./CommentsSingle.vue_vue_type_style_index_0_scoped_d9c21e0c_lang-4be19a88.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";import{c as T}from"./createLucideIcon-c54a04d6.js";import{P as ce}from"./pen-a0648bf7.js";/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=T("EllipsisVerticalIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=T("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-vue-next v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=T("HeartIcon",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),be={class:"fixed inset-0 bg-dark-300/80 backdrop-blur-sm flex items-end justify-center sm:items-center p-4 z-50"},xe={class:"px-6 py-4 border-b border-dark-100 flex items-center justify-between"},ge={class:"flex items-center space-x-3"},ye={class:"relative"},ve={class:"absolute bottom-3 right-3 text-sm text-gray-400"},he={key:0,class:"mt-2 text-red-400 text-sm flex items-center space-x-1"},ke={class:"mt-6 bg-dark-300/50 rounded-lg p-4"},_e={class:"flex items-center space-x-2 text-gray-300"},we={class:"mt-6 flex items-center justify-end space-x-3"},Ce=["disabled"],Se={class:"flex items-center space-x-2"},$e=J({__name:"Comment",props:{modelClass:{type:String,default:""},modelId:{type:Number,default:0},keyEditor:{type:String,default:null},commentClass:{type:String,default:"w-full rounded-lg"}},emits:["fresh-comments","close"],setup(V,{emit:P}){const c=K(),s=g(!1),a=g(!1),i=g(!1),y=V;let m=g(""),h=g("");const k=P;se(()=>{setTimeout(()=>{s.value=!0},50)});const M=()=>{s.value=!1,setTimeout(()=>{k("close")},300)},R=async()=>{if(m.value.trim()===""){a.value=!0;return}a.value=!1,i.value=!0;const I={title:h.value,comment:m.value,model:y.modelClass,model_id:y.modelId};try{const l=await F.post(route("comment.add"),I);c.success(l.data.message),m.value="",h.value="",k("fresh-comments"),M()}catch(l){for(const[E,w]of Object.entries(l.response.data.errors))c.error(w[0])}finally{i.value=!1}};return(I,l)=>(o(),n("div",be,[e("div",{class:A(["w-full max-w-2xl bg-dark-200 rounded-xl shadow-2xl transform transition-all duration-300 ease-out",{"translate-y-0 opacity-100":s.value,"translate-y-8 opacity-0":!s.value}])},[e("div",xe,[e("div",ge,[d(r(Q),{class:"w-5 h-5 text-blue-400"}),l[1]||(l[1]=e("h3",{class:"text-lg font-medium text-white"},"Add Your Comment",-1))]),e("button",{onClick:M,class:"text-gray-400 hover:text-white transition-colors duration-200"},[d(r(Y),{class:"w-5 h-5"})])]),r($)().props.isUserAuth?(o(),n("form",{key:0,onSubmit:U(R,["prevent"]),class:"p-6"},[e("div",{class:A(y.commentClass)},[e("div",ye,[H(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=E=>_(m)?m.value=E:m=E),placeholder:"Share your thoughts...",class:A(["w-full min-h-[120px] bg-dark-300 text-gray-200 rounded-lg p-4 border border-dark-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all duration-200 placeholder-gray-500",{"border-red-500":a.value}])},null,2),[[z,r(m)]]),e("div",ve,j(r(m).length)+" / 1000 ",1)]),a.value?(o(),n("div",he,[d(r(ne),{class:"w-4 h-4"}),l[2]||(l[2]=e("span",null,"Please enter your comment",-1))])):f("",!0),e("div",ke,[e("div",_e,[d(r(ae),{class:"w-4 h-4 text-blue-400"}),l[3]||(l[3]=e("span",{class:"text-sm"},"Please follow our community guidelines, you may use markdown syntax.",-1))])]),e("div",we,[e("button",{type:"button",onClick:M,class:"px-4 py-2 bg-dark-300 hover:bg-dark-100 text-gray-300 rounded-lg transition-colors duration-200 flex items-center space-x-2"},[d(r(Y),{class:"w-4 h-4"}),l[4]||(l[4]=e("span",null,"Cancel",-1))]),e("button",{type:"submit",disabled:i.value,class:"relative group px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e("div",Se,[d(r(ie),{class:"w-4 h-4 transition-transform duration-200 group-hover:translate-x-0.5"}),e("span",null,j(i.value?"Sending...":"Submit"),1)])],8,Ce)])],2)],32)):f("",!0)],2)]))}}),Me={class:"relative py-4 md:py-6"},je={class:"relative bg-dark-700/50 rounded-lg p-4 md:p-6 hover:bg-dark-600/50 transition-colors duration-200"},Ee={class:"flex gap-3 md:gap-4"},Fe={class:"flex flex-col items-center flex-shrink-0"},Ae={class:"w-10 h-10 md:w-12 md:h-12"},Ie=["src","alt"],Ve={class:"mt-1 px-2 py-0.5 bg-dark-500/80 rounded-full text-[10px] md:text-xs text-gray-300"},Pe={key:0,class:"mt-1 px-2 py-0.5 bg-purple-500/20 rounded-full text-[10px] md:text-xs text-purple-400"},Re={class:"flex-1 min-w-0"},Ue={class:"flex justify-between items-start gap-2"},He={class:"flex items-baseline gap-2"},ze={class:"text-sm md:text-base font-semibold text-gray-200"},Te={class:"text-xs text-gray-400"},De={key:0,class:"dropdown dropdown-left"},Be={tabindex:"0",class:"btn btn-ghost btn-xs md:btn-sm p-1 h-auto min-h-0"},Ne={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow-lg bg-dark-800 rounded-lg w-40"},Le={key:0},Oe={key:1},qe={class:"mt-2"},Xe={key:0,class:"text-gray-300 prose prose-invert prose-sm max-w-none"},Ze={class:"flex justify-end gap-2"},We={class:"flex items-center gap-3 mt-3"},Ye={key:0,class:"ml-8 md:ml-12 mt-2 space-y-2"},Ge={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Je={class:"relative bg-dark-700 rounded-xl p-6 max-w-lg w-full"},Ke={key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Qe={class:"relative bg-dark-700 rounded-xl p-6 max-w-lg w-full"},et={class:"text-center"},tt={class:"mt-6 flex justify-end gap-3"},st=J({__name:"CommentsSingle",props:{comment:{type:Object,required:!0},keyEditor:{type:String,default:null},isReply:{type:Boolean,default:!1}},emits:["fresh-comments"],setup(V,{emit:P}){const c=K(),s=V;g(!1);let a=g(!1),i=g(!1);p(()=>y.value||m.value||h.value||k.value);const y=p(()=>s.comment.likes_last_hour>5),m=p(()=>s.comment.is_helpful>=10),h=p(()=>s.comment.is_featured),k=p(()=>s.comment.is_highlighted);p(()=>y.value?"hot-frame":m.value?"popular-frame":h.value?"featured-frame":k.value?"highlighted-frame":""),p(()=>y.value?"bg-gradient-to-r from-orange-500/20 via-red-500/20 to-orange-500/20":m.value?"bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-blue-500/20":h.value?"bg-gradient-to-r from-yellow-500/20 via-amber-500/20 to-yellow-500/20":k.value?"bg-gradient-to-r from-green-500/20 via-emerald-500/20 to-green-500/20":""),p(()=>y.value?"bg-red-500/90 text-white":m.value?"bg-purple-500/90 text-white":h.value?"bg-yellow-500/90 text-black":k.value?"bg-green-500/90 text-white":""),p(()=>y.value?"🔥 Hot":m.value?"⭐ Popular":h.value?"👑 Featured":k.value?"📌 Highlighted":"");const M=p(()=>{var v,t,x,S;return((t=(v=$().props.authUserInfo)==null?void 0:v.data)==null?void 0:t.id)===((S=(x=s.comment)==null?void 0:x.user)==null?void 0:S.id)}),R=p(()=>M.value||$().props.guard==="admin"),I=async()=>{if($().props.isUserAuth)try{await F.post(route("mark.helpful",s.comment.id)),w()}catch{c.error("Failed to mark as helpful")}},l=async()=>{if(confirm("Are you sure you want to delete this comment?"))try{await F.delete(route("comment.delete",s.comment.id)),c.success("Comment deleted"),w()}catch{c.error("Failed to delete comment")}},E=async()=>{if(!s.comment.body.trim()){c.error("Comment cannot be empty");return}try{await F.post(route("comment.edit",s.comment.id),{comment:s.comment.body.trim()}),a.value=!1,w()}catch{c.error("Failed to update comment")}},w=()=>{i.value=!1,ee("fresh-comments")},ee=P;let b=g(!1),C=g("");const te=async()=>{var v,t;if(!C.value.trim()){c.error("Please provide a reason for reporting");return}try{const x=await F.post(route("comment.report",s.comment.id),{reason:C.value.trim()});c.success(x.data.message),b.value=!1,C.value=""}catch(x){(t=(v=x.response)==null?void 0:v.data)!=null&&t.errors?Object.values(x.response.data.errors).forEach(S=>{c.error(S[0])}):c.error("Failed to report comment")}};return(v,t)=>{var x,S,D,B,N,L,O,q,X;return o(),n("article",Me,[e("div",je,[e("div",Ee,[e("div",Fe,[e("div",Ae,[e("img",{src:(S=(x=s.comment)==null?void 0:x.user)==null?void 0:S.avatar,alt:(B=(D=s.comment)==null?void 0:D.user)==null?void 0:B.full_name,class:"rounded-full h-full w-full object-cover"},null,8,Ie)]),e("div",Ve," Level "+j(((N=s.comment.user)==null?void 0:N.level)||"1"),1),(O=(L=s.comment)==null?void 0:L.user)!=null&&O.has_subscription?(o(),n("div",Pe," Subscriber ")):f("",!0)]),e("div",Re,[e("div",Ue,[e("div",null,[e("div",He,[e("h3",ze,j((q=s.comment.user)==null?void 0:q.full_name),1),e("time",Te," Posted "+j(s.comment.created_at_diff),1)])]),r($)().props.isUserAuth?(o(),n("div",De,[e("label",Be,[d(r(pe),{class:"w-4 h-4 text-gray-400"})]),e("ul",Ne,[M.value?(o(),n("li",Le,[e("button",{onClick:t[0]||(t[0]=u=>_(a)?a.value=!r(a):a=!r(a)),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-300 hover:bg-dark-600"},[d(r(ce),{class:"w-4 h-4"}),t[8]||(t[8]=Z(" Edit "))])])):f("",!0),R.value?(o(),n("li",Oe,[e("button",{onClick:l,class:"flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-dark-600"},[d(r(de),{class:"w-4 h-4"}),t[9]||(t[9]=Z(" Delete "))])])):f("",!0)])])):f("",!0)]),e("div",qe,[r(a)?(o(),n("form",{key:1,onSubmit:U(E,["prevent"]),class:"space-y-2"},[H(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=u=>s.comment.body=u),class:"w-full bg-dark-800 rounded-lg p-3 text-sm text-gray-200 border border-dark-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",rows:"3"},null,512),[[z,s.comment.body]]),e("div",Ze,[e("button",{type:"button",onClick:t[2]||(t[2]=u=>_(a)?a.value=!1:a=!1),class:"btn btn-ghost btn-xs md:btn-sm"}," Cancel "),t[10]||(t[10]=e("button",{type:"submit",class:"btn btn-primary btn-xs md:btn-sm"}," Update ",-1))])],32)):(o(),n("div",Xe,[d(me,{content:s.comment.body},null,8,["content"])]))]),e("div",We,[r($)().props.guard==="web"?(o(),n("button",{key:0,onClick:I,class:A(["inline-flex items-center gap-1.5 text-sm",s.comment.user_helpful_Comments?"text-purple-400":"text-gray-400"])},[d(r(fe),{class:A([s.comment.user_helpful_Comments?"fill-current":"","w-4 h-4"])},null,8,["class"]),e("span",null,j(s.comment.is_helpful),1)],2)):f("",!0),r($)().props.isUserAuth?(o(),n("button",{key:1,onClick:t[3]||(t[3]=u=>_(i)?i.value=!r(i):i=!r(i)),class:"inline-flex items-center gap-1.5 text-sm text-gray-400"},[d(r(Q),{class:"w-4 h-4"}),t[11]||(t[11]=e("span",{class:"hidden md:inline"},"Reply",-1))])):f("",!0),e("button",{onClick:t[4]||(t[4]=u=>_(b)?b.value=!r(b):b=!r(b)),class:"inline-flex items-center gap-1.5 text-sm text-gray-400"},[d(r(G),{class:"w-4 h-4"}),t[12]||(t[12]=e("span",{class:"hidden md:inline"},"Report",-1))])])])])]),(X=s.comment.replies)!=null&&X.length?(o(),n("div",Ye,[t[13]||(t[13]=e("div",{class:"absolute left-5 md:left-6 top-16 bottom-0 w-px bg-purple-500/20"},null,-1)),(o(!0),n(re,null,oe(s.comment.replies,u=>(o(),W(rt,{key:u.id,comment:u,"key-editor":s.keyEditor,"is-reply":!0,onFreshComments:w},null,8,["comment","key-editor"]))),128))])):f("",!0),(o(),W(le,{to:"body"},[r(i)?(o(),n("div",Ge,[t[14]||(t[14]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",Je,[d($e,{"model-class":"comment","model-id":s.comment.id,"key-editor":s.keyEditor,onFreshComments:w,onClose:t[5]||(t[5]=u=>_(i)?i.value=!1:i=!1)},null,8,["model-id","key-editor"])])])):f("",!0),r(b)?(o(),n("div",Ke,[t[17]||(t[17]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",Qe,[e("div",et,[d(r(G),{class:"w-12 h-12 text-yellow-400 mx-auto"}),t[15]||(t[15]=e("h3",{class:"mt-4 text-xl font-medium text-gray-200"},"Report Comment",-1))]),e("form",{onSubmit:U(te,["prevent"]),class:"mt-6"},[H(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=u=>_(C)?C.value=u:C=u),placeholder:"Please describe why you're reporting this comment...",class:"w-full bg-dark-800 rounded-lg p-4 text-sm text-gray-200 border border-dark-600 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",rows:"4"},null,512),[[z,r(C)]]),e("div",tt,[e("button",{type:"button",onClick:t[7]||(t[7]=u=>_(b)?b.value=!1:b=!1),class:"btn btn-ghost btn-sm"}," Cancel "),t[16]||(t[16]=e("button",{type:"submit",class:"btn btn-warning btn-sm"}," Submit Report ",-1))])],32)])])):f("",!0)]))])}}}),rt=ue(st,[["__scopeId","data-v-d9c21e0c"]]);export{fe as H,rt as S,$e as _};
