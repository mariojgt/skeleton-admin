import{a as f,o as a,g as l,d as t,s as _,t as u,e as x,u as c,i as y,f as C,v as V,z as R,x as j,F as g}from"./preset-fafa7a54.js";import{_ as w}from"./Input.vue_vue_type_script_setup_true_lang-7234bc69.js";const I={class:"max-w-lg mx-auto p-6 bg-dark-blue-300 rounded-lg shadow-lg space-y-6"},L={key:0,class:"space-y-6"},U={class:"text-center"},A={class:"p-4 bg-dark-200 rounded-lg inline-block"},M=["innerHTML"],N={class:"text-sm text-gray-400 mt-4"},B={class:"text-white font-semibold"},F={key:1},S={class:"overflow-x-auto bg-gray-700 rounded-lg p-4"},E={class:"w-full text-left text-gray-200"},O={class:"py-2"},T={class:"py-2"},Y={key:2,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},D={class:"bg-gray-800 rounded-lg p-6 max-w-sm w-full text-center space-y-4"},z={__name:"AutenticatorManager",props:{userInfo:Object,autenticatorInfo:Object},setup(p){const d=p;let s=f(""),r=f(!1);const h=()=>{g.post(route("user.2fa.enable"),{code:s.value})},v=()=>{g.post(route("castle.unlock.backup.code"),{code:s.value}),i()},k=()=>{const m=d.autenticatorInfo.backup_codes.map(b=>`${b.code},${b.used?"Yes":"No"}`).join(`
`),e=new Blob([m],{type:"text/csv"}),o=URL.createObjectURL(e),n=document.createElement("a");n.href=o,n.download="backup_codes.csv",n.click(),URL.revokeObjectURL(o)},i=()=>{r.value=!r.value};return(m,e)=>(a(),l("div",I,[e[8]||(e[8]=t("h2",{class:"text-center text-2xl font-semibold text-white"}," Two-Factor Authentication ",-1)),d.autenticatorInfo.is_enable?(a(),l("div",F,[e[5]||(e[5]=t("h3",{class:"text-xl font-medium text-white text-center"}," Backup Codes ",-1)),e[6]||(e[6]=t("p",{class:"text-center text-gray-400 mb-4"}," Save these backup codes to access your account if you lose access to your authenticator. ",-1)),t("div",S,[t("table",E,[e[4]||(e[4]=t("thead",null,[t("tr",null,[t("th",{class:"py-2"},"Code"),t("th",{class:"py-2"},"Used")])],-1)),t("tbody",null,[(a(!0),l(V,null,R(p.autenticatorInfo.backup_codes,(o,n)=>(a(),l("tr",{key:n},[t("td",O,u(o.code),1),t("td",T,u(o.used?"Yes":"No"),1)]))),128))])])]),t("div",{class:"flex flex-col sm:flex-row gap-3 mt-6"},[t("button",{class:"w-full sm:w-auto btn btn-primary",onClick:k},"Download CSV"),t("button",{class:"w-full sm:w-auto btn btn-secondary",onClick:i},"Remove Authenticator")])])):(a(),l("div",L,[t("div",U,[t("div",A,[t("div",{innerHTML:d.autenticatorInfo.codeinfo.qr_code},null,8,M)]),t("p",N,[e[2]||(e[2]=_(" Scan this QR code to set up two-factor authentication. You can also enter the code manually: ")),t("span",B,u(d.autenticatorInfo.codeinfo.secret),1)])]),t("form",{onSubmit:C(h,["prevent"]),class:"space-y-4"},[x(c(w),{modelValue:c(s),"onUpdate:modelValue":e[0]||(e[0]=o=>y(s)?s.value=o:s=o),label:"Authentication Code",type:"text",name:"code",placeholder:"Enter code",labelClass:"block text-white font-medium mb-2",inputClass:"w-full p-3 rounded-lg bg-gray-900 text-white placeholder-gray-500"},null,8,["modelValue"]),e[3]||(e[3]=t("button",{type:"submit",class:"w-full btn btn-secondary py-2"},"Activate",-1))],32)])),c(r)?(a(),l("div",Y,[t("div",D,[e[7]||(e[7]=t("h4",{class:"text-lg font-semibold text-white"},"Confirm Removal",-1)),x(c(w),{modelValue:c(s),"onUpdate:modelValue":e[1]||(e[1]=o=>y(s)?s.value=o:s=o),label:"Enter Code",type:"text",name:"code",placeholder:"Code to confirm",inputClass:"w-full p-3 rounded-lg bg-gray-900 text-white placeholder-gray-500"},null,8,["modelValue"]),t("div",{class:"flex gap-4 justify-center"},[t("button",{class:"btn btn-primary",onClick:v},"Confirm"),t("button",{class:"btn",onClick:i},"Cancel")])])])):j("",!0)]))}};export{z as default};
