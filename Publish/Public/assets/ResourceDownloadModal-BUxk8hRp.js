import{a as y}from"./axios-_QDD2PZU.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as S}from"./circle-x-CZUopObt.js";import{C as R}from"./crown-Q_hRGcZ7.js";import{T as M}from"./timer-dHC_Ll8z.js";import{D as A}from"./download-Br1fYmfn.js";import{a as n,k as P,g as a,d as e,e as u,u as b,t as d,p,aw as E,o as r}from"./index-WItOpbdS.js";import"./createLucideIcon-B_m21LnD.js";const N={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},T={class:"relative w-full max-w-lg p-6 rounded-xl overflow-hidden"},V={class:"relative z-10"},z={key:0,class:"flex flex-col items-center justify-center py-8"},G={key:1,class:"text-center py-8"},H={class:"w-20 h-20 rounded-full bg-red-500/20 flex items-center justify-center mx-auto mb-4"},L={class:"text-[#BAD9FC] mb-6"},U={key:2,class:"py-4"},W={class:"flex justify-center mb-4"},Z={class:"p-4 rounded-full bg-[#253D63]/80 border border-[#8B60ED]/30 shadow-xl"},q={key:3,class:"py-4"},J={class:"flex justify-center mb-4"},Q={class:"p-4 rounded-full bg-[#253D63]/80 border border-[#F19A1A]/30 shadow-xl"},Y={key:0,class:"bg-[#253D63]/80 p-4 rounded-lg mb-6 text-center"},O={class:"text-white font-bold"},X={key:4,class:"py-4"},$={class:"flex justify-center mb-4"},K={class:"p-4 rounded-full bg-[#253D63]/80 border border-[#1AAB8B]/30 shadow-xl"},ee={class:"bg-[#253D63]/80 p-4 rounded-lg mb-6"},te={class:"flex justify-between items-center mb-2"},se={class:"text-white font-bold"},oe={class:"flex justify-between items-center mb-2"},le={class:"text-white font-bold"},ae={class:"flex justify-between items-center"},re={class:"text-white font-bold"},ne={key:0,class:"mt-3"},ie={class:"h-2 w-full bg-[#253D63] rounded-full overflow-hidden"},de={key:5,class:"py-4"},ce={class:"flex justify-center mb-4"},ue={class:"p-4 rounded-full bg-[#253D63]/80 border border-[#1AAB8B]/30 shadow-xl"},be={class:"bg-[#253D63]/80 p-4 rounded-lg mb-6"},ve={class:"flex justify-between items-center mb-2"},xe={class:"text-white font-bold"},me={__name:"ResourceDownloadModal",props:{showModal:{type:Boolean,default:!1},resource:{type:Object,required:!0}},emits:["close","subscribe","downloaded"],setup(v,{emit:_}){const x=v,m=_,i=n(!0),w=n(!1),f=n(""),c=n(!1),g=n(!1),h=n(!1),D=n(!1),o=n(null),l=()=>{m("close")},B=()=>{m("subscribe"),l()},C=s=>s?new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"",F=async()=>{i.value=!0,w.value=!1;try{const t=(await y.get(route("gamedev.lesson.resources.check-capability",x.resource.id))).data;c.value=t.can_download,g.value=t.capability_required,h.value=t.subscription_required||!1,D.value=t.usage_limit_reached||!1,t.capability_details&&(o.value=t.capability_details,x.resource.estimated_size=t.capability_details.resource_size)}catch(s){console.error("Error checking capability:",s),f.value="Failed to check download capability. Please try again.",s.value=!0}finally{i.value=!1}},k=async()=>{i.value=!0,w.value=!1;try{const t=(await y.get(route("gamedev.lesson.resources.download",x.resource.id))).data.download_url;window.open(t,"_blank"),m("downloaded"),l()}catch(s){console.error("Download error:",s),f.value="Failed to generate download link. Please try again.",s.value=!0}finally{i.value=!1}},I=async()=>{i.value=!0,w.value=!1;try{const t=(await y.get(route("gamedev.lesson.resources.download",x.resource.id))).data.download_url;window.open(t,"_blank"),m("downloaded"),l()}catch(s){console.error("Download error:",s),f.value="Failed to generate download link. Please try again.",s.value=!0}finally{i.value=!1}};return P(()=>{F()}),(s,t)=>v.showModal?(r(),a("div",N,[e("div",{class:"absolute inset-0 bg-[#1E2F4A]/80 backdrop-blur-sm",onClick:l}),e("div",T,[t[16]||(t[16]=e("div",{class:"absolute inset-0"},[e("div",{class:"absolute inset-0 bg-gradient-to-br from-[#328AF1]/10 via-[#8B60ED]/10 to-[#21C8F6]/10 opacity-30"}),e("div",{class:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDUgTCA1IDAgTSAxNSAwIEwgMjAgNSBNIDAgMTUgTCA1IDIwIE0gMTUgMjAgTCAyMCAxNSIgc3Ryb2tlPSIjQkFEOUZDIiBzdHJva2Utd2lkdGg9IjAuNSIgc3Ryb2tlLW9wYWNpdHk9IjAuMSIvPjwvcGF0dGVybj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+')] opacity-20"}),e("div",{class:"absolute inset-0 bg-[#1E2A42]/90 border-2 border-[#328AF1]/30 rounded-xl"})],-1)),e("div",V,[i.value?(r(),a("div",z,t[0]||(t[0]=[e("div",{class:"w-16 h-16 border-4 border-t-[#8B60ED] border-r-[#328AF1] border-b-[#21C8F6] border-l-[#1AAB8B] border-t-4 rounded-full animate-spin"},null,-1),e("p",{class:"mt-4 text-lg text-[#BAD9FC]"},"Checking download capability...",-1)]))):w.value?(r(),a("div",G,[e("div",H,[u(b(S),{class:"w-12 h-12 text-red-500"})]),t[1]||(t[1]=e("h3",{class:"text-xl font-bold text-white mb-2"},"Download Error",-1)),e("p",L,d(f.value),1),e("button",{onClick:l,class:"px-4 py-2 bg-[#328AF1] hover:bg-[#21C8F6] text-white rounded-lg transition-colors"}," Close ")])):!c.value&&h.value?(r(),a("div",U,[e("div",W,[e("div",Z,[u(b(R),{class:"w-12 h-12 text-[#8B60ED]"})])]),t[2]||(t[2]=e("h3",{class:"text-2xl font-bold text-white text-center mb-2"},"Premium Content",-1)),t[3]||(t[3]=e("p",{class:"text-[#BAD9FC] text-center mb-6"},"This lesson resource requires an active subscription plan.",-1)),e("div",{class:"flex justify-center space-x-4"},[e("button",{onClick:l,class:"px-4 py-2 bg-[#253D63] hover:bg-[#324D73] text-white rounded-lg transition-colors"}," Cancel "),e("button",{onClick:B,class:"px-4 py-2 bg-gradient-to-r from-[#8B60ED] to-[#B372BD] hover:from-[#B372BD] hover:to-[#8B60ED] text-white rounded-lg transition-colors"}," Subscribe Now ")])])):!c.value&&D.value?(r(),a("div",q,[e("div",J,[e("div",Q,[u(b(M),{class:"w-12 h-12 text-[#F19A1A]"})])]),t[5]||(t[5]=e("h3",{class:"text-2xl font-bold text-white text-center mb-2"},"Download Limit Reached",-1)),t[6]||(t[6]=e("p",{class:"text-[#BAD9FC] text-center mb-2"},"You've reached your lesson resource download limit for this billing cycle.",-1)),o.value&&o.value.next_reset?(r(),a("div",Y,[t[4]||(t[4]=e("p",{class:"text-[#BAD9FC]"},"Your lesson downloads will reset on:",-1)),e("p",O,d(C(o.value.next_reset)),1)])):p("",!0),e("div",{class:"flex justify-center"},[e("button",{onClick:l,class:"px-4 py-2 bg-[#328AF1] hover:bg-[#21C8F6] text-white rounded-lg transition-colors"}," Close ")])])):c.value&&g.value?(r(),a("div",X,[e("div",$,[e("div",K,[u(b(A),{class:"w-12 h-12 text-[#1AAB8B]"})])]),t[10]||(t[10]=e("h3",{class:"text-2xl font-bold text-white text-center mb-2"},"Download Lesson Resource",-1)),t[11]||(t[11]=e("p",{class:"text-[#BAD9FC] text-center mb-4"},"This download will use your lesson resource subscription allowance.",-1)),e("div",ee,[e("div",te,[t[7]||(t[7]=e("span",{class:"text-[#BAD9FC]"},"Resource:",-1)),e("span",se,d(v.resource.title),1)]),e("div",oe,[t[8]||(t[8]=e("span",{class:"text-[#BAD9FC]"},"Downloads used:",-1)),e("span",le,d(o.value.usage_count)+" / "+d(o.value.usage_limit===-1?"∞":o.value.usage_limit),1)]),e("div",ae,[t[9]||(t[9]=e("span",{class:"text-[#BAD9FC]"},"Downloads remaining:",-1)),e("span",re,d(o.value.remaining===-1?"∞":o.value.remaining),1)]),o.value.usage_limit!==-1?(r(),a("div",ne,[e("div",ie,[e("div",{class:"h-full bg-gradient-to-r from-[#328AF1] to-[#21C8F6]",style:E({width:`${o.value.usage_count/o.value.usage_limit*100}%`})},null,4)])])):p("",!0)]),e("div",{class:"flex justify-center space-x-4"},[e("button",{onClick:l,class:"px-4 py-2 bg-[#253D63] hover:bg-[#324D73] text-white rounded-lg transition-colors"}," Cancel "),e("button",{onClick:k,class:"px-4 py-2 bg-gradient-to-r from-[#328AF1] to-[#21C8F6] hover:from-[#21C8F6] hover:to-[#328AF1] text-white rounded-lg transition-colors"}," Download Now ")])])):c.value&&!g.value?(r(),a("div",de,[e("div",ce,[e("div",ue,[u(b(A),{class:"w-12 h-12 text-[#1AAB8B]"})])]),t[14]||(t[14]=e("h3",{class:"text-2xl font-bold text-white text-center mb-2"},"Download Lesson Resource",-1)),t[15]||(t[15]=e("p",{class:"text-[#BAD9FC] text-center mb-4"},"This download is included with your subscription!",-1)),e("div",be,[e("div",ve,[t[12]||(t[12]=e("span",{class:"text-[#BAD9FC]"},"Resource:",-1)),e("span",xe,d(v.resource.title),1)]),t[13]||(t[13]=e("div",{class:"mt-3 flex items-center justify-center"},[e("div",{class:"px-3 py-1 bg-[#1AAB8B]/20 rounded-full border border-[#1AAB8B]/30"},[e("span",{class:"text-[#1AAB8B] font-medium text-sm"},"Resource is free :)")])],-1))]),e("div",{class:"flex justify-center space-x-4"},[e("button",{onClick:l,class:"px-4 py-2 bg-[#253D63] hover:bg-[#324D73] text-white rounded-lg transition-colors"}," Cancel "),e("button",{onClick:I,class:"px-4 py-2 bg-gradient-to-r from-[#1AAB8B] to-[#6EDCC4] hover:from-[#6EDCC4] hover:to-[#1AAB8B] text-white rounded-lg transition-colors"}," Download Now ")])])):p("",!0)])])])):p("",!0)}},_e=j(me,[["__scopeId","data-v-a577e381"]]);export{_e as default};
