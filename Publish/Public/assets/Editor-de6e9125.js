import{bv as S,a4 as L,bc as F,a as w,aB as D,p as I,aF as k,aD as K,aH as R,h as V,bI as x,o as T,g as N,f as z,u as h,i as G,A as H,bK as q}from"./preset-26b1ee33.js";var W=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],J=function(e){return W.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},Q=function(e,t,n){Object.keys(t).filter(J).forEach(function(a){var r=t[a];typeof r=="function"&&(a==="onInit"?r(e,n):n.on(a.substring(2),function(i){return r(i,n)}))})},X=function(e,t,n,a){var r=e.modelEvents?e.modelEvents:null,i=Array.isArray(r)?r.join(" "):r;S(a,function(l,u){n&&typeof l=="string"&&l!==u&&l!==n.getContent({format:e.outputFormat})&&n.setContent(l)}),n.on(i||"change input undo redo",function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},Y=function(e,t,n,a,r,i){a.setContent(i()),n.attrs["onUpdate:modelValue"]&&X(t,n,a,r),Q(e,n.attrs,a)},_=0,M=function(e){var t=Date.now(),n=Math.floor(Math.random()*1e9);return _++,e+"_"+n+_+String(t)},Z=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},A=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},$=function(e,t){return A(e).concat(A(t))},ee=function(e){return e==null},B=function(){return{listeners:[],scriptId:M("tiny-script"),scriptLoaded:!1}},ne=function(){var e=B(),t=function(r,i,l,u){var o=i.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=r,o.src=l;var v=function(){o.removeEventListener("load",v),u()};o.addEventListener("load",v),i.head&&i.head.appendChild(o)},n=function(r,i,l){e.scriptLoaded?l():(e.listeners.push(l),r.getElementById(e.scriptId)||t(e.scriptId,r,i,function(){e.listeners.forEach(function(u){return u()}),e.scriptLoaded=!0}))},a=function(){e=B()};return{load:n,reinitialize:a}},te=ne(),oe=function(){return typeof window<"u"?window:global},g=function(){var e=oe();return e&&e.tinymce?e.tinymce:null},ae={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},f=globalThis&&globalThis.__assign||function(){return f=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},f.apply(this,arguments)},re=function(e,t,n,a){return e(a||"div",{id:t,ref:n})},ie=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},E={selector:void 0,target:void 0},le=L({props:ae,setup:function(e,t){var n=e.init?f(f({},e.init),E):f({},E),a=F(e),r=a.disabled,i=a.modelValue,l=a.tagName,u=w(null),o=null,v=e.id||M("tiny-vue"),c=e.init&&e.init.inline||e.inline,y=!!t.attrs["onUpdate:modelValue"],m=!0,O=e.initialValue?e.initialValue:"",C="",P=function(d){return y?function(){return i!=null&&i.value?i.value:""}:function(){return d?O:C}},b=function(){var d=P(m),s=f(f({},n),{readonly:e.disabled,target:u.value,plugins:$(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:c,setup:function(p){o=p,p.on("init",function(j){return Y(j,e,t,p,i,d)}),typeof n.setup=="function"&&n.setup(p)}});Z(u.value)&&(u.value.style.visibility=""),g().init(s),m=!1};S(r,function(d){var s;o!==null&&(typeof((s=o.mode)===null||s===void 0?void 0:s.set)=="function"?o.mode.set(d?"readonly":"design"):o.setMode(d?"readonly":"design"))}),S(l,function(d){var s;y||(C=o.getContent()),(s=g())===null||s===void 0||s.remove(o),D(function(){return b()})}),I(function(){if(g()!==null)b();else if(u.value&&u.value.ownerDocument){var d=e.cloudChannel?e.cloudChannel:"6",s=e.apiKey?e.apiKey:"no-api-key",p=ee(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(s,"/tinymce/").concat(d,"/tinymce.min.js"):e.tinymceScriptSrc;te.load(u.value.ownerDocument,p,b)}}),k(function(){g()!==null&&g().remove(o)}),c||(K(function(){m||b()}),R(function(){var d;y||(C=o.getContent()),(d=g())===null||d===void 0||d.remove(o)}));var U=function(d){var s;C=o.getContent(),(s=g())===null||s===void 0||s.remove(o),n=f(f(f({},n),d),E),D(function(){return b()})};return t.expose({rerender:U,getEditor:function(){return o}}),function(){return c?re(V,v,u,e.tagName):ie(V,v,u)}}}),ue=typeof self=="object"?self.FormData:window.FormData;const de=x(ue),ce={__name:"Editor",props:{modelValue:{type:String,default:""},editor_key:{type:String,default:null}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e;let a=null;const r=o=>{a=o.editor,a.on("change",v=>{i()})},i=()=>{t("update:modelValue",l.value)};let l=w(null),u=w(!1);return I(()=>{l.value=n.modelValue,u.value=!0}),S(()=>l.value,o=>{u.value&&i()}),(o,v)=>(T(),N("div",null,[z(h(le),{"api-key":n.editor_key,modelValue:h(l),"onUpdate:modelValue":v[0]||(v[0]=c=>G(l)?l.value=c:l=c),init:{plugins:"lists link image table code help wordcount codesample importcss",toolbar:"undo redo | image code | codesample",content_css:"/my-styles.css",setup:c=>r({editor:c}),images_upload_handler:async c=>{let y=new h(de)();y.append("file",c.blob(),c.filename());try{const m=await h(H).post(h(q)().props.upload_media,y,{headers:{"Content-Type":"multipart/form-data"}});if(m.data&&m.data.data.url.default)return m.data.data.url.default;throw new o.Error("Unable to upload image")}catch{throw new o.Error("Unable to upload image")}}}},null,8,["api-key","modelValue","init"])]))}};export{ce as _};
