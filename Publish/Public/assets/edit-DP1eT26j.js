import{a as c,b as g,w,o as i,d as t,e as r,u as d,l as m,g as u,p as x,t as l,n as R,F as U,z as j,f as V,x as p,D as $,y as N,I as X,H as y}from"./index-WItOpbdS.js";import{_ as Z}from"./App-YzpOsBfZ.js";import{_ as tt,a as M}from"./Modal-koSbuhPx.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as et,R as nt}from"./refresh-ccw-HiQ0xrwq.js";import{R as B}from"./refresh-cw-Baqh8J4k.js";import{B as ot,S as F}from"./square-pen-DT6EUZg-.js";import{M as lt}from"./mail-BO47lLg7.js";import{U as it}from"./user-DdnhHvPw.js";import{H as at}from"./history-DE24IReM.js";import"./FlashMessage-CHM72Nyp.js";import"./index-Dv4gq3Lz.js";import"./bell-Btq0QMyD.js";import"./createLucideIcon-B_m21LnD.js";import"./bell-off-7yGDgxWn.js";import"./trash-DWR5SLDJ.js";import"./circle-check-big-D4oY-uLV.js";import"./info-pjT6XQSI.js";import"./triangle-alert-WvWLgC-B.js";import"./search-Cw9ASmoG.js";import"./arrow-right-DR4DXPKm.js";import"./x-D_G4-85w.js";const rt={class:"container mx-auto p-4"},dt={class:"flex justify-between items-center mb-6"},ut={class:"flex space-x-2"},ct={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},bt={class:"col-span-2"},mt={class:"card bg-base-100 shadow-lg overflow-hidden mb-6"},pt={class:"card-body p-6"},ft={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},vt={class:"font-mono text-sm"},xt={class:"flex items-center mt-1"},yt={class:"flex items-center mt-1"},gt={class:"flex items-center mt-1"},wt={class:"flex items-center mt-1"},Ct={class:"card bg-base-100 shadow-lg overflow-hidden"},ht={class:"card-body p-6"},kt={class:"overflow-x-auto"},St={class:"table table-zebra w-full"},_t={key:0},Dt={class:"font-mono text-xs"},Et={key:1},Ut={class:"col-span-1"},Vt={class:"card bg-base-100 shadow-lg overflow-hidden mb-6"},Mt={class:"card-body p-6"},Pt={class:"flex items-center mb-4"},jt={class:"avatar placeholder"},$t={class:"bg-primary text-primary-content rounded-full w-12"},Nt={class:"ml-3"},It={class:"font-semibold"},At={class:"text-sm text-base-content/70"},Rt={class:"flex flex-col space-y-2"},Bt=["href"],Ft={href:"#",class:"btn btn-outline btn-sm w-full"},Tt={href:"#",class:"btn btn-outline btn-sm w-full"},qt={class:"card bg-base-100 shadow-lg overflow-hidden"},Ht={class:"card-body p-6"},Ot={class:"space-y-3"},zt={class:"font-medium"},Lt={class:"font-medium"},Yt={class:"font-medium"},Wt={key:0},Gt={class:"text-sm"},Jt={class:"p-4"},Kt={class:"mb-4"},Qt=["value"],Xt={class:"flex justify-end space-x-2"},Zt={class:"p-4"},ts={class:"grid grid-cols-1 gap-4"},ss={class:"flex justify-end space-x-2 mt-4"},es={class:"p-4"},ns={class:"mb-4"},os=["value"],ls={class:"mb-4"},is={class:"flex items-center cursor-pointer"},as={class:"flex justify-end space-x-2"},rs=["disabled"],ds={class:"p-4"},us={class:"grid grid-cols-2 gap-4"},cs={class:"flex justify-end space-x-2 mt-4"},bs={__name:"edit",props:{subscription:{type:Object,required:!0},duration_left:{type:String,required:!0},statuses:{type:Object,required:!0},plans:{type:Array,required:!0}},setup(o){const a=o,C=c(!1),h=c(!1),k=c(!1),S=c(!1),_=c(a.subscription.status),f=c({start_date:E(a.subscription.start_date),end_date:E(a.subscription.end_date)}),b=c({plan_id:"",adjust_end_date:!0}),v=c({duration:1,duration_type:"months"});function D(n){return n?new Date(n).toLocaleDateString():"N/A"}function E(n){return n?new Date(n).toISOString().split("T")[0]:""}function P(n){return n==null?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n)}function T(n){return!n||!n.name?"?":n.name.split(" ").map(s=>s[0]).slice(0,2).join("").toUpperCase()}function q(n){switch(n.toLowerCase()){case"completed":return"bg-success/20 text-success";case"pending":return"bg-warning/20 text-warning";case"failed":return"bg-error/20 text-error";case"refunded":return"bg-info/20 text-info";default:return"bg-base-300 text-base-content"}}function H(){_.value=a.subscription.status,C.value=!0}function O(){f.value={start_date:E(a.subscription.start_date),end_date:E(a.subscription.end_date)},h.value=!0}function I(){b.value={plan_id:"",adjust_end_date:!0},k.value=!0}function z(){v.value={duration:1,duration_type:"months"},S.value=!0}async function L(){try{const n=await y.put(route("admin.store.subscriptions.update-status",a.subscription.id),{status:_.value});window.location.reload()}catch(n){console.error("Error updating status:",n),alert("Error updating subscription status")}}async function Y(){try{await y.put(route("admin.store.subscriptions.update-dates",a.subscription.id),f.value),window.location.reload()}catch(n){console.error("Error updating dates:",n),alert("Error updating subscription dates")}}async function W(){try{await y.put(route("admin.store.subscriptions.change-plan",a.subscription.id),b.value),window.location.reload()}catch(n){console.error("Error changing plan:",n),alert("Error changing subscription plan")}}async function G(){try{await y.put(route("admin.store.subscriptions.extend",a.subscription.id),v.value),window.location.reload()}catch(n){console.error("Error extending subscription:",n),alert("Error extending subscription")}}function J(){confirm("Are you sure you want to cancel this subscription?")&&K()}async function K(){try{await y.put(route("admin.store.subscriptions.cancel",a.subscription.id)),window.location.reload()}catch(n){console.error("Error cancelling subscription:",n),alert("Error cancelling subscription")}}async function Q(){try{await y.put(route("admin.store.subscriptions.toggle-renew",a.subscription.id)),window.location.reload()}catch(n){console.error("Error toggling auto-renew:",n),alert("Error updating auto-renew setting")}}return(n,s)=>(i(),g(Z,null,{default:w(()=>[t("div",rt,[t("div",dt,[t("div",ut,[t("button",{onClick:z,class:"btn btn-success"},[r(d(et),{class:"w-5 h-5 mr-1"}),s[15]||(s[15]=m(" Extend "))]),t("button",{onClick:I,class:"btn btn-warning"},[r(d(B),{class:"w-5 h-5 mr-1"}),s[16]||(s[16]=m(" Change Plan "))]),o.subscription.status!=="cancelled"?(i(),u("button",{key:0,onClick:J,class:"btn btn-error"},[r(d(ot),{class:"w-5 h-5 mr-1"}),s[17]||(s[17]=m(" Cancel "))])):x("",!0)])]),t("div",ct,[t("div",bt,[t("div",mt,[t("div",pt,[s[25]||(s[25]=t("h2",{class:"card-title mb-4"},"Subscription Overview",-1)),t("div",ft,[t("div",null,[s[18]||(s[18]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Subscription ID",-1)),t("p",vt,l(o.subscription.subscription_id||"N/A"),1)]),t("div",null,[s[19]||(s[19]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Status",-1)),t("div",xt,[r(tt,{status:o.subscription.status},null,8,["status"]),t("button",{onClick:H,class:"btn btn-xs btn-ghost ml-2"},[r(d(F),{class:"w-3 h-3"})])])]),t("div",null,[s[20]||(s[20]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Auto Renew",-1)),t("div",yt,[t("div",{class:R(["badge",o.subscription.auto_renew?"badge-success":"badge-error"])},l(o.subscription.auto_renew?"Yes":"No"),3),t("button",{onClick:Q,class:"btn btn-xs btn-ghost ml-2"},[r(d(nt),{class:"w-3 h-3"})])])]),t("div",null,[s[21]||(s[21]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Created",-1)),t("p",null,l(D(o.subscription.created_at)),1)]),t("div",null,[s[22]||(s[22]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Start Date",-1)),t("div",gt,[t("p",null,l(D(o.subscription.start_date)),1),t("button",{onClick:O,class:"btn btn-xs btn-ghost ml-2"},[r(d(F),{class:"w-3 h-3"})])])]),t("div",null,[s[23]||(s[23]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"End Date",-1)),t("div",wt,[t("p",null,l(D(o.subscription.end_date)),1)])]),t("div",null,[s[24]||(s[24]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Time Remaining",-1)),t("p",null,l(o.duration_left),1)])])])]),t("div",Ct,[t("div",ht,[s[28]||(s[28]=t("h2",{class:"card-title mb-4"},"Payment History",-1)),t("div",kt,[t("table",St,[s[27]||(s[27]=t("thead",null,[t("tr",null,[t("th",null,"Date"),t("th",null,"Amount"),t("th",null,"Method"),t("th",null,"Status"),t("th",null,"Transaction ID")])],-1)),t("tbody",null,[o.subscription.payments&&o.subscription.payments.length>0?(i(),u("tr",_t,[(i(!0),u(U,null,j(o.subscription.payments,e=>(i(),u(U,{key:e.id},[t("td",null,l(D(e.created_at)),1),t("td",null,l(P(e.amount)),1),t("td",null,l(e.payment_method),1),t("td",null,[t("span",{class:R(["px-2 py-1 text-xs font-medium rounded-full",q(e.status)])},l(e.status),3)]),t("td",Dt,l(e.transaction_id),1)],64))),128))])):(i(),u("tr",Et,s[26]||(s[26]=[t("td",{colspan:"5",class:"text-center py-4"},"No payment records found",-1)])))])])])])])]),t("div",Ut,[t("div",Vt,[t("div",Mt,[s[32]||(s[32]=t("h2",{class:"card-title mb-4"},"User Information",-1)),t("div",Pt,[t("div",jt,[t("div",$t,[t("span",null,l(T(o.subscription.user)),1)])]),t("div",Nt,[t("p",It,l(o.subscription.user.name),1),t("p",At,l(o.subscription.user.email),1)])]),s[33]||(s[33]=t("div",{class:"divider my-2"},null,-1)),t("div",Rt,[t("a",{href:`mailto:${o.subscription.user.email}`,class:"btn btn-outline btn-sm w-full"},[r(d(lt),{class:"w-4 h-4 mr-2"}),s[29]||(s[29]=m(" Email User "))],8,Bt),t("a",Ft,[r(d(it),{class:"w-4 h-4 mr-2"}),s[30]||(s[30]=m(" View Profile "))]),t("a",Tt,[r(d(at),{class:"w-4 h-4 mr-2"}),s[31]||(s[31]=m(" View All Subscriptions "))])])])]),t("div",qt,[t("div",Ht,[s[39]||(s[39]=t("h2",{class:"card-title mb-4"},"Plan Information",-1)),t("div",Ot,[t("div",null,[s[34]||(s[34]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Name",-1)),t("p",zt,l(o.subscription.plan.name),1)]),t("div",null,[s[35]||(s[35]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Price",-1)),t("p",Lt,l(P(o.subscription.plan.price)),1)]),t("div",null,[s[36]||(s[36]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Duration",-1)),t("p",Yt,l(o.subscription.plan.duration)+" "+l(o.subscription.plan.duration_type),1)]),o.subscription.plan.description?(i(),u("div",Wt,[s[37]||(s[37]=t("h3",{class:"text-sm font-semibold text-base-content/70"},"Description",-1)),t("p",Gt,l(o.subscription.plan.description),1)])):x("",!0)]),s[40]||(s[40]=t("div",{class:"divider my-3"},null,-1)),t("button",{onClick:I,class:"btn btn-outline btn-sm w-full"},[r(d(B),{class:"w-4 h-4 mr-2"}),s[38]||(s[38]=m(" Change Plan "))])])])])])]),C.value?(i(),g(M,{key:0,onClose:s[2]||(s[2]=e=>C.value=!1),title:"Update Status"},{default:w(()=>[t("div",Jt,[t("form",{onSubmit:V(L,["prevent"])},[t("div",Kt,[s[41]||(s[41]=t("label",{class:"block text-sm font-medium mb-2"},"Status",-1)),p(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>_.value=e),class:"select select-bordered w-full"},[(i(!0),u(U,null,j(o.statuses,(e,A)=>(i(),u("option",{key:A,value:A},l(e),9,Qt))),128))],512),[[$,_.value]])]),t("div",Xt,[t("button",{type:"button",class:"btn btn-ghost",onClick:s[1]||(s[1]=e=>C.value=!1)}," Cancel "),s[42]||(s[42]=t("button",{type:"submit",class:"btn btn-primary"},"Update Status",-1))])],32)])]),_:1})):x("",!0),h.value?(i(),g(M,{key:1,onClose:s[6]||(s[6]=e=>h.value=!1),title:"Update Dates"},{default:w(()=>[t("div",Zt,[t("form",{onSubmit:V(Y,["prevent"])},[t("div",ts,[t("div",null,[s[43]||(s[43]=t("label",{class:"block text-sm font-medium mb-2"},"Start Date",-1)),p(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>f.value.start_date=e),type:"date",class:"input input-bordered w-full"},null,512),[[N,f.value.start_date]])]),t("div",null,[s[44]||(s[44]=t("label",{class:"block text-sm font-medium mb-2"},"End Date",-1)),p(t("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>f.value.end_date=e),type:"date",class:"input input-bordered w-full"},null,512),[[N,f.value.end_date]])])]),t("div",ss,[t("button",{type:"button",class:"btn btn-ghost",onClick:s[5]||(s[5]=e=>h.value=!1)}," Cancel "),s[45]||(s[45]=t("button",{type:"submit",class:"btn btn-primary"},"Update Dates",-1))])],32)])]),_:1})):x("",!0),k.value?(i(),g(M,{key:2,onClose:s[10]||(s[10]=e=>k.value=!1),title:"Change Plan"},{default:w(()=>[t("div",es,[t("form",{onSubmit:V(W,["prevent"])},[t("div",ns,[s[47]||(s[47]=t("label",{class:"block text-sm font-medium mb-2"},"New Plan",-1)),p(t("select",{"onUpdate:modelValue":s[7]||(s[7]=e=>b.value.plan_id=e),class:"select select-bordered w-full"},[s[46]||(s[46]=t("option",{value:"",disabled:""},"Select a plan",-1)),(i(!0),u(U,null,j(o.plans,e=>(i(),u("option",{key:e.id,value:e.id},l(e.name)+" - "+l(P(e.price)),9,os))),128))],512),[[$,b.value.plan_id]])]),t("div",ls,[t("label",is,[p(t("input",{"onUpdate:modelValue":s[8]||(s[8]=e=>b.value.adjust_end_date=e),type:"checkbox",class:"checkbox checkbox-primary mr-2"},null,512),[[X,b.value.adjust_end_date]]),s[48]||(s[48]=t("span",{class:"label-text"},"Adjust end date based on new plan",-1))])]),t("div",as,[t("button",{type:"button",class:"btn btn-ghost",onClick:s[9]||(s[9]=e=>k.value=!1)}," Cancel "),t("button",{type:"submit",class:"btn btn-primary",disabled:!b.value.plan_id}," Change Plan ",8,rs)])],32)])]),_:1})):x("",!0),S.value?(i(),g(M,{key:3,onClose:s[14]||(s[14]=e=>S.value=!1),title:"Extend Subscription"},{default:w(()=>[t("div",ds,[t("form",{onSubmit:V(G,["prevent"])},[t("div",us,[t("div",null,[s[49]||(s[49]=t("label",{class:"block text-sm font-medium mb-2"},"Duration",-1)),p(t("input",{"onUpdate:modelValue":s[11]||(s[11]=e=>v.value.duration=e),type:"number",min:"1",class:"input input-bordered w-full"},null,512),[[N,v.value.duration]])]),t("div",null,[s[51]||(s[51]=t("label",{class:"block text-sm font-medium mb-2"},"Duration Type",-1)),p(t("select",{"onUpdate:modelValue":s[12]||(s[12]=e=>v.value.duration_type=e),class:"select select-bordered w-full"},s[50]||(s[50]=[t("option",{value:"days"},"Days",-1),t("option",{value:"weeks"},"Weeks",-1),t("option",{value:"months"},"Months",-1),t("option",{value:"years"},"Years",-1)]),512),[[$,v.value.duration_type]])])]),t("div",cs,[t("button",{type:"button",class:"btn btn-ghost",onClick:s[13]||(s[13]=e=>S.value=!1)}," Cancel "),s[52]||(s[52]=t("button",{type:"submit",class:"btn btn-primary"},"Extend Subscription",-1))])],32)])]),_:1})):x("",!0)]),_:1}))}},Is=st(bs,[["__scopeId","data-v-f03ff8ac"]]);export{Is as default};
