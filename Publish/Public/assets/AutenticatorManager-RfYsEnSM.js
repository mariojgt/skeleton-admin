import{ak as I,a as v,g as n,d as t,e as r,u as a,t as u,f as M,x as y,y as h,i as _,l as w,F as D,z as L,p as S,G as k,o as l,n as T}from"./index-WItOpbdS.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as b}from"./shield-Be_G51qQ.js";import{K as A}from"./key-uG_gkCpc.js";import{D as V}from"./download-Br1fYmfn.js";import{T as R}from"./triangle-alert-WvWLgC-B.js";import"./createLucideIcon-B_m21LnD.js";const B={class:"max-w-2xl mx-auto"},E={class:"bg-dark-500/90 backdrop-blur-sm rounded-xl border border-gray-800/50 overflow-hidden"},N={class:"relative p-6 text-center border-b border-gray-800/50"},z={class:"relative"},O={class:"inline-flex items-center gap-3 mb-4"},G={class:"relative"},H={class:"text-gray-400"},K={class:"p-6"},q={key:0,class:"space-y-8"},P={class:"flex flex-col items-center"},Q={class:"p-4 bg-white rounded-xl"},Y=["innerHTML"],J={class:"mt-4 text-center max-w-md"},W={class:"bg-dark-400/50 px-4 py-2 rounded-lg font-mono text-sm text-blue-400 break-all"},X={class:"space-y-2"},Z={class:"relative"},$={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},tt={type:"submit",class:"group relative w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white font-medium rounded-lg transition-all duration-300 hover:from-blue-600 hover:to-purple-600"},et={key:1,class:"space-y-8"},st={class:"space-y-4"},ot={class:"flex items-center justify-between"},at={class:"flex gap-2"},rt={class:"bg-dark-400/30 rounded-lg overflow-hidden"},nt={class:"overflow-x-auto"},lt={class:"w-full text-left"},it={class:"divide-y divide-gray-800/30"},dt={class:"px-6 py-4 font-mono text-gray-300"},ct={class:"px-6 py-4"},ut={class:"pt-6 border-t border-gray-800/50"},pt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},bt={class:"relative w-full max-w-md bg-dark-500 rounded-xl border border-gray-800/50 shadow-2xl"},ft={class:"p-6 space-y-6"},xt={class:"text-center"},gt={class:"space-y-4"},mt={class:"relative"},vt={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},yt={__name:"AutenticatorManager",props:{userInfo:Object,autenticatorInfo:Object},setup(f){const x=I("route"),i=f;let o=v(""),c=v(!1);const C=()=>{k.post(x("user.2fa.enable"),{code:o.value})},j=()=>{k.post(x("castle.unlock.backup.code"),{code:o.value}),p()},F=()=>{const g=i.autenticatorInfo.backup_codes.map(m=>`${m.code},${m.used?"Yes":"No"}`).join(`
`),e=new Blob([g],{type:"text/csv"}),s=URL.createObjectURL(e),d=document.createElement("a");d.href=s,d.download="backup_codes.csv",d.click(),URL.revokeObjectURL(s)},p=()=>{c.value=!c.value,c.value||(o.value="")};return(g,e)=>(l(),n("div",B,[t("div",E,[t("div",N,[e[4]||(e[4]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-blue-500/5 to-purple-500/5"},null,-1)),t("div",z,[t("div",O,[t("div",G,[e[2]||(e[2]=t("div",{class:"absolute -inset-2 bg-gradient-to-r from-blue-500/20 to-purple-500/20 rounded-full blur"},null,-1)),r(a(b),{class:"w-10 h-10 text-blue-400 relative"})]),e[3]||(e[3]=t("h2",{class:"text-2xl font-bold text-white"},"Two-Factor Authentication",-1))]),t("p",H,u(i.autenticatorInfo.is_enable?"Manage your two-factor authentication settings and backup codes":"Enhance your account security with 2FA authentication"),1)])]),t("div",K,[i.autenticatorInfo.is_enable?(l(),n("div",et,[t("div",st,[t("div",ot,[e[10]||(e[10]=t("h3",{class:"text-xl font-bold text-white"},"Backup Codes",-1)),t("div",at,[t("button",{onClick:F,class:"flex items-center gap-2 px-4 py-2 bg-dark-400/50 hover:bg-dark-300/50 text-gray-300 hover:text-white rounded-lg transition-all duration-300"},[r(a(V),{class:"w-4 h-4"}),e[9]||(e[9]=w(" Download CSV "))])])]),t("div",rt,[t("div",nt,[t("table",lt,[e[11]||(e[11]=t("thead",{class:"border-b border-gray-800/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-sm font-medium text-gray-400"},"Code"),t("th",{class:"px-6 py-3 text-sm font-medium text-gray-400"},"Status")])],-1)),t("tbody",it,[(l(!0),n(D,null,L(f.autenticatorInfo.backup_codes,(s,d)=>(l(),n("tr",{key:d,class:"hover:bg-dark-300/30 transition-colors duration-200"},[t("td",dt,u(s.code),1),t("td",ct,[t("span",{class:T(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.used?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400"])},u(s.used?"Used":"Available"),3)])]))),128))])])])])]),t("div",ut,[t("button",{onClick:p,class:"flex items-center gap-2 px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg transition-all duration-300"},[r(a(b),{class:"w-4 h-4"}),e[12]||(e[12]=w(" Disable 2FA "))])])])):(l(),n("div",q,[t("div",P,[t("div",Q,[t("div",{innerHTML:i.autenticatorInfo.codeinfo.qr_code},null,8,Y)]),t("div",J,[e[5]||(e[5]=t("p",{class:"text-gray-400 mb-2"}," Scan this QR code with your authenticator app or enter the code manually: ",-1)),t("div",W,u(i.autenticatorInfo.codeinfo.secret),1)])]),t("form",{onSubmit:M(C,["prevent"]),class:"space-y-6"},[t("div",X,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-300"}," Authentication Code ",-1)),t("div",Z,[t("div",$,[r(a(A),{class:"h-5 w-5 text-gray-400"})]),y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>_(o)?o.value=s:o=s),type:"text",placeholder:"Enter the 6-digit code",class:"w-full pl-10 pr-4 py-3 bg-dark-400/50 border border-gray-800/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all duration-300"},null,512),[[h,a(o)]])])]),t("button",tt,[e[7]||(e[7]=t("div",{class:"absolute top-0 -inset-full h-full w-1/2 z-5 block transform -skew-x-12 bg-gradient-to-r from-transparent to-white opacity-20 group-hover:animate-shine"},null,-1)),r(a(b),{class:"w-5 h-5"}),e[8]||(e[8]=t("span",null,"Activate 2FA",-1))])],32)]))])]),a(c)?(l(),n("div",pt,[e[15]||(e[15]=t("div",{class:"absolute inset-0 bg-black/80 backdrop-blur-sm"},null,-1)),t("div",bt,[t("div",ft,[t("div",xt,[r(a(R),{class:"w-12 h-12 text-red-400 mx-auto mb-4"}),e[13]||(e[13]=t("h3",{class:"text-xl font-bold text-white mb-2"},"Disable 2FA Authentication",-1)),e[14]||(e[14]=t("p",{class:"text-gray-400"},"Please enter your authentication code to confirm disabling 2FA.",-1))]),t("div",gt,[t("div",mt,[t("div",vt,[r(a(A),{class:"h-5 w-5 text-gray-400"})]),y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>_(o)?o.value=s:o=s),type:"text",placeholder:"Enter authentication code",class:"w-full pl-10 pr-4 py-3 bg-dark-400/50 border border-gray-800/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-red-500/50 focus:border-transparent transition-all duration-300"},null,512),[[h,a(o)]])]),t("div",{class:"flex gap-3"},[t("button",{onClick:j,class:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors duration-300"}," Disable 2FA "),t("button",{onClick:p,class:"flex-1 px-4 py-3 bg-dark-400 hover:bg-dark-300 text-gray-300 font-medium rounded-lg transition-colors duration-300"}," Cancel ")])])])])])):S("",!0)]))}},Ft=U(yt,[["__scopeId","data-v-1fef1ad9"]]);export{Ft as default};
