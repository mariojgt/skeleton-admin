import{y as P,bZ as G,a as g,o as l,g as d,u as n,Q as k,f as T,d as t,E as V,G as F,i as b,l as Q,x,t as A,b as R,s as S,e as f,X as Z,v as O,z as J,w as E}from"./preset-59cdb044.js";import{a as _}from"./axios-d44f9c8c.js";import"./index.esm-df9f2d71.js";import{_ as q}from"./ReusableModal-023b7711.js";import{_ as w}from"./dynamicIcon.vue_vue_type_script_setup_true_lang-9716a120.js";const K={class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 p-4 border border-gray-700 rounded-lg bg-dark-blue-100 text-white w-2/4"},W=P({__name:"Comment",props:{modelClass:{type:String,default:""},modelId:{type:Number,default:0},keyEditor:{type:String,default:null},commentClass:{type:String,default:"w-full rounded-lg"}},emits:["fresh-comments","close"],setup(j,{emit:$}){const i=G(),s=j;let u=g(""),r=g("");const p=$,M=async()=>{const h={title:r.value,comment:u.value,model:s.modelClass,model_id:s.modelId};if(u.value===""){i.error("The comment is required");return}await _.post(route("comment.add"),h).then(function(o){i.success(o.data.message)}).catch(function(o){for(const[y,U]of Object.entries(o.response.data.errors))i.error(U[0])}),u.value="",r.value="",p("fresh-comments"),p("close")},m=async()=>{p("close")};return(h,o)=>(l(),d("div",K,[n(k)().props.isUserAuth?(l(),d("form",{key:0,onSubmit:T(M,["prevent"])},[t("div",{class:Q(s.commentClass)},[o[3]||(o[3]=t("label",{for:"comment",class:"text-xl font-bold"},"Your comment",-1)),V(t("textarea",{placeholder:"Comment",class:"textarea textarea-bordered textarea-lg w-full mt-2","onUpdate:modelValue":o[0]||(o[0]=y=>b(u)?u.value=y:u=y)},null,512),[[F,n(u)]]),t("div",{class:"flex justify-between"},[o[2]||(o[2]=t("h5",null,"Please Follow the guidelines",-1)),t("div",{class:"mt-2 flex justify-end gap-3"},[t("div",{onClick:m,class:"btn btn-primary mt-2"}," Cancel "),o[1]||(o[1]=t("button",{class:"btn btn-secondary mt-2"},"Submit",-1))])])],2)],32)):x("",!0)]))}}),ee={class:"mt-5 bg-dark-400 rounded-lg p-3 shadow-lg hover:bg-dark-400"},te={class:"flex items-center mb-4 space-x-4"},se=["src"],oe=["src"],ne={class:"space-y-1 font-medium text-white"},le={class:"mr-2 block text-lg font-bold text-white"},ae=["datetime"],re=["innerHTML"],me={class:"flex items-center justify-between mt-4"},de={class:"flex items-center"},ie={class:"text-lg font-bold"},ue={key:0,class:"flex items-center space-x-2"},ce={class:"dropdown dropdown-left"},fe={tabindex:"0",class:"btn btn-sm btn-primary m-1"},be={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52 gap-2"},pe={class:"mt-2"},ye={class:"flex flex-col items-center space-x-2"},xe={class:"flex flex-col w-full gap-2"},ve=P({__name:"CommentsSingle",props:{comment:{type:Object,default:()=>{}},keyEditor:{type:String,default:null}},emits:["fresh-comments"],setup(j,{emit:$}){const i=G(),s=j,u=$;let r=g(!1),p=g("");const M=async()=>{r.value=!1,await _.post(route("comment.report",s.comment.id),{reason:p.value}).then(function(c){i.success(c.data.message)}).catch(function(c){for(const[e,C]of Object.entries(c.response.data.errors))i.error(C[0])}),y()};let m=g(!1);const h=async()=>{m.value=!1,await _.delete(route("comment.delete",s.comment.id)).then(function(c){i.success(c.data.message)}),y()};let o=g(!1);const y=async()=>{o.value=!1,u("fresh-comments")},U=async()=>{k().props.isUserAuth&&(await _.post(route("mark.helpful",s.comment.id)).then(function(c){i.success(c.data.message)}),y())};let v=g(!1);const X=async()=>{const c={comment:s.comment.body};if(s.comment.body===""){i.error("The comment is required");return}await _.post(route("comment.edit",s.comment.id),c).then(function(e){i.success(e.data.message)}).catch(function(e){for(const[C,I]of Object.entries(e.response.data.errors))i.error(I[0])}),u("fresh-comments"),v.value=!1};return(c,e)=>{var C,I,z,H,N,B,D,L;return l(),d(O,null,[t("article",ee,[t("div",te,[(I=(C=s.comment)==null?void 0:C.user)!=null&&I.avatar?(l(),d("img",{key:0,class:"w-20 h-20 rounded-md",src:s.comment.user.avatar,alt:"User Avatar"},null,8,se)):x("",!0),(H=(z=s.comment)==null?void 0:z.admin)!=null&&H.avatar?(l(),d("img",{key:1,class:"w-12 h-12 rounded-md",src:s.comment.admin.avatar,alt:"Admin Avatar"},null,8,oe)):x("",!0),t("div",ne,[t("p",null,[t("a",le,A(s.comment.user.full_name),1),t("time",{datetime:s.comment.created_at_diff,class:"block text-sm text-gray-400"}," Posted "+A(s.comment.created_at_diff),9,ae)]),n(v)?x("",!0):(l(),d("div",{key:0,class:"text-gray-200 text-base",innerHTML:s.comment.body},null,8,re))])]),n(v)?(l(),d("form",{key:0,onSubmit:T(X,["prevent"])},[V(t("textarea",{placeholder:"Comment",class:"textarea textarea-bordered textarea-lg w-full mt-2","onUpdate:modelValue":e[0]||(e[0]=a=>s.comment.body=a)},null,512),[[F,s.comment.body]]),e[10]||(e[10]=t("button",{class:"btn btn-secondary mt-2 w-full"},"Update",-1))],32)):x("",!0),t("div",me,[t("div",de,[n(k)().props.guard==="web"?(l(),d("button",{key:0,class:Q(["btn btn-sm btn-primary hover:btn-accent text-white hover:text-black",s.comment.user_helpful_Comments?"btn-secondary":"btn-primary"]),onClick:U},[s.comment.user_helpful_Comments?(l(),R(w,{key:0,componentId:"heartSolid"})):(l(),R(w,{key:1,componentId:"heart"})),t("span",ie,A(s.comment.is_helpful),1)],2)):x("",!0)]),n(k)().props.isUserAuth?(l(),d("div",ue,[t("button",{class:"btn btn-sm btn-secondary hover:btn-accent text-white hover:text-black",onClick:e[1]||(e[1]=a=>b(o)?o.value=!n(o):o=!n(o))},[e[11]||(e[11]=S(" Reply ")),f(w,{componentId:"reply"})]),t("div",ce,[t("label",fe,[f(w,{componentId:"dots"})]),t("ul",be,[t("li",null,[t("button",{class:"btn btn-primary hover:btn-secondary text-white hover:text-black btn-sm flex justify-between",onClick:e[2]||(e[2]=a=>b(r)?r.value=!n(r):r=!n(r))},[e[12]||(e[12]=S(" Report abuse ")),f(w,{componentId:"alert",class:"size-6"})])]),t("li",null,[t("button",{onClick:e[3]||(e[3]=a=>b(v)?v.value=!n(v):v=!n(v)),class:"btn btn-secondary btn-sm flex justify-between"},[e[13]||(e[13]=S(" Edit ")),f(w,{componentId:"edit"})])]),t("li",null,[((B=(N=n(k)().props.authUserInfo)==null?void 0:N.data)==null?void 0:B.id)===((L=(D=s.comment)==null?void 0:D.user)==null?void 0:L.id)||n(k)().props.guard==="admin"?(l(),d("button",{key:0,class:"btn btn-error hover:btn-secondary text-white hover:text-black btn-sm flex justify-between",onClick:e[4]||(e[4]=a=>b(m)?m.value=!0:m=!0)},[e[14]||(e[14]=S(" Delete ")),f(w,{componentId:"trash"})])):x("",!0)])])])])):x("",!0)]),n(o)?(l(),R(Z,{key:1,to:"body"},[f(W,{"model-class":"comment","comment-class":"w-full","model-id":s.comment.id,"key-editor":s.keyEditor,onFreshComments:y,onClose:e[5]||(e[5]=a=>b(o)?o.value=!1:o=!1)},null,8,["model-id","key-editor"])])):x("",!0)]),(l(!0),d(O,null,J(s.comment.replies,(a,Y)=>(l(),d("div",{key:Y,class:"ml-10 mt-4"},[f(ve,{comment:a,"key-editor":s.keyEditor,onFreshComments:y},null,8,["comment","key-editor"])]))),128)),f(n(q),{show:n(m),onClose:e[7]||(e[7]=a=>b(m)?m.value=!1:m=!1),onConfirm:h,modalClass:"bg-dark-100",showHeader:!1,showFooter:!1},{body:E(()=>[t("div",pe,[t("div",ye,[f(w,{componentId:"alert",class:"size-14"}),e[15]||(e[15]=t("h1",{class:"mt-2 text-xl font-semibold"}," Are you sure? ",-1)),e[16]||(e[16]=t("p",{class:"mt-3 text-lg font-bold"},"If you proceed, your comment (and any replies to it) will be deleted.",-1)),t("div",xe,[t("button",{class:"btn btn-outline btn-secondary",onClick:e[6]||(e[6]=a=>b(m)?m.value=!1:m=!1)}," Cancel "),t("button",{class:"btn btn-secondary",onClick:h}," Delete ")])])])]),_:1},8,["show"]),f(n(q),{show:n(r),onClose:e[9]||(e[9]=a=>b(r)?r.value=!1:r=!1),showHeader:!0,showFooter:!1,modalClass:"bg-primary",isLarge:!0},{title:E(()=>e[17]||(e[17]=[t("header",{class:"text-center md:px-12 text-neutral"},[t("h2",{class:"text-4xl font-semibold"},"Report abuse")],-1)])),body:E(()=>[t("form",{onSubmit:T(M,["prevent"]),class:"rounded-lg"},[V(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=a=>b(p)?p.value=a:p=a),placeholder:"Reason",class:"textarea textarea-bordered textarea-lg w-full font-bold mt-2"},null,512),[[F,n(p)]]),e[18]||(e[18]=t("button",{type:"submit",class:"btn btn-warning mt-3 w-full rounded-lg text-xl font-bold"}," Report ",-1))],32)]),_:1},8,["show"])],64)}}});export{ve as _,W as a};
