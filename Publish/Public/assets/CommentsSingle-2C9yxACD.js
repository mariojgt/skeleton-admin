import{q as J,a as v,k as ee,o,g as l,d as e,e as u,u as r,A as y,f as V,n as U,x as H,y as z,i as _,t as A,p as c,v as p,l as W,F as te,z as se,b as X,au as re}from"./index-DQfThwAa.js";import{a as E}from"./axios-BpmJAKNE.js";import{s as h}from"./index-CToPLI8H.js";import{M as K}from"./message-circle-0W-QY5IG.js";import{X as Y}from"./x-CvCFfHKA.js";import{C as oe,I as le}from"./info-D7U56PFf.js";import{S as ne,M as ae}from"./Markdown-CYFa4jft.js";/* empty css                                                                       */import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as ue,P as de,H as me,F as G}from"./pen-Dy3kVaqR.js";import{T as ce}from"./trash-2-DCUdtpRt.js";const pe={class:"fixed inset-0 bg-dark-300/80 backdrop-blur-sm flex items-end justify-center sm:items-center p-4 z-50"},fe={class:"px-6 py-4 border-b border-dark-100 flex items-center justify-between"},be={class:"flex items-center space-x-3"},ve={class:"relative"},ge={class:"absolute bottom-3 right-3 text-sm text-gray-400"},xe={key:0,class:"mt-2 text-red-400 text-sm flex items-center space-x-1"},ye={class:"mt-6 bg-dark-300/50 rounded-lg p-4"},he={class:"flex items-center space-x-2 text-gray-300"},we={class:"mt-6 flex items-center justify-end space-x-3"},ke=["disabled"],_e={class:"flex items-center space-x-2"},Ce=J({__name:"Comment",props:{modelClass:{type:String,default:""},modelId:{type:Number,default:0},keyEditor:{type:String,default:null},commentClass:{type:String,default:"w-full rounded-lg"}},emits:["fresh-comments","close"],setup(P,{emit:R}){const s=v(!1),a=v(!1),i=v(!1),g=P;let d=v(""),w=v("");const k=R;ee(()=>{setTimeout(()=>{s.value=!0},50)});const C=()=>{s.value=!1,setTimeout(()=>{k("close")},300)},T=async()=>{if(d.value.trim()===""){a.value=!0;return}a.value=!1,i.value=!0;const M={title:w.value,comment:d.value,model:g.modelClass,model_id:g.modelId};try{const n=await E.post(route("comment.add"),M);h("success",n.data.message,"success"),d.value="",w.value="",k("fresh-comments"),C()}catch(n){for(const[F,S]of Object.entries(n.response.data.errors))message.error(S[0])}finally{i.value=!1}};return(M,n)=>(o(),l("div",pe,[e("div",{class:U(["w-full max-w-2xl bg-dark-200 rounded-xl shadow-2xl transform transition-all duration-300 ease-out",{"translate-y-0 opacity-100":s.value,"translate-y-8 opacity-0":!s.value}])},[e("div",fe,[e("div",be,[u(r(K),{class:"w-5 h-5 text-blue-400"}),n[1]||(n[1]=e("h3",{class:"text-lg font-medium text-white"},"Add Your Comment",-1))]),e("button",{onClick:C,class:"text-gray-400 hover:text-white transition-colors duration-200"},[u(r(Y),{class:"w-5 h-5"})])]),r(y)().props.isUserAuth?(o(),l("form",{key:0,onSubmit:V(T,["prevent"]),class:"p-6"},[e("div",{class:U(g.commentClass)},[e("div",ve,[H(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=F=>_(d)?d.value=F:d=F),placeholder:"Share your thoughts...",class:U(["w-full min-h-[120px] bg-dark-300 text-gray-200 rounded-lg p-4 border border-dark-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all duration-200 placeholder-gray-500",{"border-red-500":a.value}])},null,2),[[z,r(d)]]),e("div",ge,A(r(d).length)+" / 1000 ",1)]),a.value?(o(),l("div",xe,[u(r(oe),{class:"w-4 h-4"}),n[2]||(n[2]=e("span",null,"Please enter your comment",-1))])):c("",!0),e("div",ye,[e("div",he,[u(r(le),{class:"w-4 h-4 text-blue-400"}),n[3]||(n[3]=e("span",{class:"text-sm"},"Please follow our community guidelines, you may use markdown syntax.",-1))])]),e("div",we,[e("button",{type:"button",onClick:C,class:"px-4 py-2 bg-dark-300 hover:bg-dark-100 text-gray-300 rounded-lg transition-colors duration-200 flex items-center space-x-2"},[u(r(Y),{class:"w-4 h-4"}),n[4]||(n[4]=e("span",null,"Cancel",-1))]),e("button",{type:"submit",disabled:i.value,class:"relative group px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e("div",_e,[u(r(ne),{class:"w-4 h-4 transition-transform duration-200 group-hover:translate-x-0.5"}),e("span",null,A(i.value?"Sending...":"Submit"),1)])],8,ke)])],2)],32)):c("",!0)],2)]))}}),Se={class:"relative py-4 md:py-6"},$e={class:"relative bg-dark-700/50 rounded-lg p-4 md:p-6 hover:bg-dark-600/50 transition-colors duration-200"},je={class:"flex gap-3 md:gap-4"},Ae={class:"flex flex-col items-center flex-shrink-0"},Fe={class:"w-10 h-10 md:w-12 md:h-12"},Ee=["src","alt"],Ue={class:"mt-1 px-2 py-0.5 bg-dark-500/80 rounded-full text-[10px] md:text-xs text-gray-300"},Me={key:0,class:"mt-1 px-2 py-0.5 bg-purple-500/20 rounded-full text-[10px] md:text-xs text-purple-400"},Pe={class:"flex-1 min-w-0"},Re={class:"flex justify-between items-start gap-2"},Te={class:"flex items-baseline gap-2"},Ve={class:"text-sm md:text-base font-semibold text-gray-200"},He={class:"text-xs text-gray-400"},ze={key:0,class:"dropdown dropdown-left"},Ie={tabindex:"0",class:"btn btn-ghost btn-xs md:btn-sm p-1 h-auto min-h-0"},Be={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow-lg bg-dark-800 rounded-lg w-40"},De={key:0},Ne={key:1},Oe={class:"mt-2"},qe={key:0,class:"text-gray-300 prose prose-invert prose-sm max-w-none"},Le={class:"flex justify-end gap-2"},We={class:"flex items-center gap-3 mt-3"},Xe={key:0,class:"ml-8 md:ml-12 mt-2 space-y-2"},Ye={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Ge={class:"relative bg-dark-700 rounded-xl p-6 max-w-lg w-full"},Je={key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Ke={class:"relative bg-dark-700 rounded-xl p-6 max-w-lg w-full"},Qe={class:"text-center"},Ze={class:"mt-6 flex justify-end gap-3"},et=J({__name:"CommentsSingle",props:{comment:{type:Object,required:!0},keyEditor:{type:String,default:null},isReply:{type:Boolean,default:!1}},emits:["fresh-comments"],setup(P,{emit:R}){const s=P;v(!1);let a=v(!1),i=v(!1);p(()=>g.value||d.value||w.value||k.value);const g=p(()=>s.comment.likes_last_hour>5),d=p(()=>s.comment.is_helpful>=10),w=p(()=>s.comment.is_featured),k=p(()=>s.comment.is_highlighted);p(()=>g.value?"hot-frame":d.value?"popular-frame":w.value?"featured-frame":k.value?"highlighted-frame":""),p(()=>g.value?"bg-gradient-to-r from-orange-500/20 via-red-500/20 to-orange-500/20":d.value?"bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-blue-500/20":w.value?"bg-gradient-to-r from-yellow-500/20 via-amber-500/20 to-yellow-500/20":k.value?"bg-gradient-to-r from-green-500/20 via-emerald-500/20 to-green-500/20":""),p(()=>g.value?"bg-red-500/90 text-white":d.value?"bg-purple-500/90 text-white":w.value?"bg-yellow-500/90 text-black":k.value?"bg-green-500/90 text-white":""),p(()=>g.value?"🔥 Hot":d.value?"⭐ Popular":w.value?"👑 Featured":k.value?"📌 Highlighted":"");const C=p(()=>{var x,t,b,j;return((t=(x=y().props.authUserInfo)==null?void 0:x.data)==null?void 0:t.id)===((j=(b=s.comment)==null?void 0:b.user)==null?void 0:j.id)}),T=p(()=>C.value||y().props.guard==="admin"),M=async()=>{if(y().props.isUserAuth)try{await E.post(route("mark.helpful",s.comment.id)),S()}catch{h("error","Failed to mark as helpful","error")}},n=async()=>{if(confirm("Are you sure you want to delete this comment?"))try{await E.delete(route("comment.delete",s.comment.id)),h("success","Comment deleted successfully","success"),S()}catch{message.error("Failed to delete comment")}},F=async()=>{if(!s.comment.body.trim()){h("error","Comment cannot be empty","error");return}try{await E.post(route("comment.edit",s.comment.id),{comment:s.comment.body.trim()}),a.value=!1,S()}catch{h("error","Failed to update comment","error")}},S=()=>{i.value=!1,Q("fresh-comments")},Q=R;let f=v(!1),$=v("");const Z=async()=>{var x,t;if(!$.value.trim()){h("error","Please describe why you're reporting this comment","error");return}try{const b=await E.post(route("comment.report",s.comment.id),{reason:$.value.trim()});h("success",b.data.message,"success"),f.value=!1,$.value=""}catch(b){(t=(x=b.response)==null?void 0:x.data)!=null&&t.errors?Object.values(b.response.data.errors).forEach(j=>{h("error",j[0],"error")}):h("error","Failed to report comment","error")}};return(x,t)=>{var b,j,I,B,D,N,O,q,L;return o(),l("article",Se,[e("div",$e,[e("div",je,[e("div",Ae,[e("div",Fe,[e("img",{src:(j=(b=s.comment)==null?void 0:b.user)==null?void 0:j.avatar,alt:(B=(I=s.comment)==null?void 0:I.user)==null?void 0:B.full_name,class:"rounded-full h-full w-full object-cover"},null,8,Ee)]),e("div",Ue," Level "+A(((D=s.comment.user)==null?void 0:D.level)||"1"),1),(O=(N=s.comment)==null?void 0:N.user)!=null&&O.has_subscription?(o(),l("div",Me," Subscriber ")):c("",!0)]),e("div",Pe,[e("div",Re,[e("div",null,[e("div",Te,[e("h3",Ve,A((q=s.comment.user)==null?void 0:q.full_name),1),e("time",He," Posted "+A(s.comment.created_at_diff),1)])]),r(y)().props.isUserAuth&&C.value?(o(),l("div",ze,[e("label",Ie,[u(r(ue),{class:"w-4 h-4 text-gray-400"})]),e("ul",Be,[C.value?(o(),l("li",De,[e("button",{onClick:t[0]||(t[0]=m=>_(a)?a.value=!r(a):a=!r(a)),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-300 hover:bg-dark-600"},[u(r(de),{class:"w-4 h-4"}),t[8]||(t[8]=W(" Edit "))])])):c("",!0),T.value?(o(),l("li",Ne,[e("button",{onClick:n,class:"flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-dark-600"},[u(r(ce),{class:"w-4 h-4"}),t[9]||(t[9]=W(" Delete "))])])):c("",!0)])])):c("",!0)]),e("div",Oe,[r(a)?(o(),l("form",{key:1,onSubmit:V(F,["prevent"]),class:"space-y-2"},[H(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=m=>s.comment.body=m),class:"w-full bg-dark-800 rounded-lg p-3 text-sm text-gray-200 border border-dark-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",rows:"3"},null,512),[[z,s.comment.body]]),e("div",Le,[e("button",{type:"button",onClick:t[2]||(t[2]=m=>_(a)?a.value=!1:a=!1),class:"btn btn-ghost btn-xs md:btn-sm"}," Cancel "),t[10]||(t[10]=e("button",{type:"submit",class:"btn btn-primary btn-xs md:btn-sm"}," Update ",-1))])],32)):(o(),l("div",qe,[u(ae,{content:s.comment.body},null,8,["content"])]))]),e("div",We,[r(y)().props.guard==="web"&&r(y)().props.isUserAuth?(o(),l("button",{key:0,onClick:M,class:U(["btn btn-error btn-sm",s.comment.user_helpful_Comments?"text-white":"text-black"])},[u(r(me),{class:U([s.comment.user_helpful_Comments?"fill-current":"","w-4 h-4"])},null,8,["class"]),e("span",null,A(s.comment.is_helpful),1)],2)):c("",!0),r(y)().props.isUserAuth?(o(),l("button",{key:1,onClick:t[3]||(t[3]=m=>_(i)?i.value=!r(i):i=!r(i)),class:"btn btn-primary btn-sm"},[u(r(K),{class:"w-4 h-4"}),t[11]||(t[11]=e("span",{class:"hidden md:inline"},"Reply",-1))])):c("",!0),r(y)().props.isUserAuth?(o(),l("button",{key:2,onClick:t[4]||(t[4]=m=>_(f)?f.value=!r(f):f=!r(f)),class:"btn btn-warning btn-sm"},[u(r(G),{class:"w-4 h-4"}),t[12]||(t[12]=e("span",{class:"hidden md:inline"},"Report",-1))])):c("",!0)])])])]),(L=s.comment.replies)!=null&&L.length?(o(),l("div",Xe,[t[13]||(t[13]=e("div",{class:"absolute left-5 md:left-6 top-16 bottom-0 w-px bg-purple-500/20"},null,-1)),(o(!0),l(te,null,se(s.comment.replies,m=>(o(),X(tt,{key:m.id,comment:m,"key-editor":s.keyEditor,"is-reply":!0,onFreshComments:S},null,8,["comment","key-editor"]))),128))])):c("",!0),(o(),X(re,{to:"body"},[r(i)?(o(),l("div",Ye,[t[14]||(t[14]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",Ge,[u(Ce,{"model-class":"comment","model-id":s.comment.id,"key-editor":s.keyEditor,onFreshComments:S,onClose:t[5]||(t[5]=m=>_(i)?i.value=!1:i=!1)},null,8,["model-id","key-editor"])])])):c("",!0),r(f)?(o(),l("div",Je,[t[17]||(t[17]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",Ke,[e("div",Qe,[u(r(G),{class:"w-12 h-12 text-yellow-400 mx-auto"}),t[15]||(t[15]=e("h3",{class:"mt-4 text-xl font-medium text-gray-200"},"Report Comment",-1))]),e("form",{onSubmit:V(Z,["prevent"]),class:"mt-6"},[H(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=m=>_($)?$.value=m:$=m),placeholder:"Please describe why you're reporting this comment...",class:"w-full bg-dark-800 rounded-lg p-4 text-sm text-gray-200 border border-dark-600 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",rows:"4"},null,512),[[z,r($)]]),e("div",Ze,[e("button",{type:"button",onClick:t[7]||(t[7]=m=>_(f)?f.value=!1:f=!1),class:"btn btn-ghost btn-sm"}," Cancel "),t[16]||(t[16]=e("button",{type:"submit",class:"btn btn-warning btn-sm"}," Submit Report ",-1))])],32)])])):c("",!0)]))])}}}),tt=ie(et,[["__scopeId","data-v-6873f1ff"]]);export{tt as S,Ce as _};
