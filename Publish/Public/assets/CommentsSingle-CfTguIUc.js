import{v as G,ab as K,a as x,m as te,o,g as n,d as e,e as d,u as r,x as $,f as H,k as A,D as T,E as z,i as k,t as E,s as f,z as p,q as J,F as se,y as re,b as W,bJ as oe}from"./preset-B9_5qsCA.js";import{a as M}from"./axios-CJJjN_l7.js";import{M as Q}from"./message-circle-CguVk335.js";import{X}from"./x-CXGfDCwX.js";import{C as le,I as ne}from"./trash-kQqe9N7F.js";import{S as ae,M as ie}from"./Markdown-DyvWIaSu.js";/* empty css                                                                       */import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as me,P as ue,H as ce,F as Y}from"./pen-CytGf7Zo.js";import{T as pe}from"./trash-2-D8fGqEgE.js";const fe={class:"fixed inset-0 bg-dark-300/80 backdrop-blur-sm flex items-end justify-center sm:items-center p-4 z-50"},be={class:"px-6 py-4 border-b border-dark-100 flex items-center justify-between"},ge={class:"flex items-center space-x-3"},xe={class:"relative"},ve={class:"absolute bottom-3 right-3 text-sm text-gray-400"},ye={key:0,class:"mt-2 text-red-400 text-sm flex items-center space-x-1"},he={class:"mt-6 bg-dark-300/50 rounded-lg p-4"},_e={class:"flex items-center space-x-2 text-gray-300"},ke={class:"mt-6 flex items-center justify-end space-x-3"},we=["disabled"],Ce={class:"flex items-center space-x-2"},Se=G({__name:"Comment",props:{modelClass:{type:String,default:""},modelId:{type:Number,default:0},keyEditor:{type:String,default:null},commentClass:{type:String,default:"w-full rounded-lg"}},emits:["fresh-comments","close"],setup(R,{emit:U}){const c=K(),s=x(!1),a=x(!1),i=x(!1),v=R;let m=x(""),h=x("");const _=U;te(()=>{setTimeout(()=>{s.value=!0},50)});const j=()=>{s.value=!1,setTimeout(()=>{_("close")},300)},V=async()=>{if(m.value.trim()===""){a.value=!0;return}a.value=!1,i.value=!0;const P={title:h.value,comment:m.value,model:v.modelClass,model_id:v.modelId};try{const l=await M.post(route("comment.add"),P);c.success(l.data.message),m.value="",h.value="",_("fresh-comments"),j()}catch(l){for(const[F,w]of Object.entries(l.response.data.errors))c.error(w[0])}finally{i.value=!1}};return(P,l)=>(o(),n("div",fe,[e("div",{class:A(["w-full max-w-2xl bg-dark-200 rounded-xl shadow-2xl transform transition-all duration-300 ease-out",{"translate-y-0 opacity-100":s.value,"translate-y-8 opacity-0":!s.value}])},[e("div",be,[e("div",ge,[d(r(Q),{class:"w-5 h-5 text-blue-400"}),l[1]||(l[1]=e("h3",{class:"text-lg font-medium text-white"},"Add Your Comment",-1))]),e("button",{onClick:j,class:"text-gray-400 hover:text-white transition-colors duration-200"},[d(r(X),{class:"w-5 h-5"})])]),r($)().props.isUserAuth?(o(),n("form",{key:0,onSubmit:H(V,["prevent"]),class:"p-6"},[e("div",{class:A(v.commentClass)},[e("div",xe,[T(e("textarea",{"onUpdate:modelValue":l[0]||(l[0]=F=>k(m)?m.value=F:m=F),placeholder:"Share your thoughts...",class:A(["w-full min-h-[120px] bg-dark-300 text-gray-200 rounded-lg p-4 border border-dark-100 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all duration-200 placeholder-gray-500",{"border-red-500":a.value}])},null,2),[[z,r(m)]]),e("div",ve,E(r(m).length)+" / 1000 ",1)]),a.value?(o(),n("div",ye,[d(r(le),{class:"w-4 h-4"}),l[2]||(l[2]=e("span",null,"Please enter your comment",-1))])):f("",!0),e("div",he,[e("div",_e,[d(r(ne),{class:"w-4 h-4 text-blue-400"}),l[3]||(l[3]=e("span",{class:"text-sm"},"Please follow our community guidelines, you may use markdown syntax.",-1))])]),e("div",ke,[e("button",{type:"button",onClick:j,class:"px-4 py-2 bg-dark-300 hover:bg-dark-100 text-gray-300 rounded-lg transition-colors duration-200 flex items-center space-x-2"},[d(r(X),{class:"w-4 h-4"}),l[4]||(l[4]=e("span",null,"Cancel",-1))]),e("button",{type:"submit",disabled:i.value,class:"relative group px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed"},[e("div",Ce,[d(r(ae),{class:"w-4 h-4 transition-transform duration-200 group-hover:translate-x-0.5"}),e("span",null,E(i.value?"Sending...":"Submit"),1)])],8,we)])],2)],32)):f("",!0)],2)]))}}),$e={class:"relative py-4 md:py-6"},je={class:"relative bg-dark-700/50 rounded-lg p-4 md:p-6 hover:bg-dark-600/50 transition-colors duration-200"},Ee={class:"flex gap-3 md:gap-4"},Fe={class:"flex flex-col items-center flex-shrink-0"},Me={class:"w-10 h-10 md:w-12 md:h-12"},Ae=["src","alt"],Pe={class:"mt-1 px-2 py-0.5 bg-dark-500/80 rounded-full text-[10px] md:text-xs text-gray-300"},Re={key:0,class:"mt-1 px-2 py-0.5 bg-purple-500/20 rounded-full text-[10px] md:text-xs text-purple-400"},Ue={class:"flex-1 min-w-0"},Ve={class:"flex justify-between items-start gap-2"},He={class:"flex items-baseline gap-2"},Te={class:"text-sm md:text-base font-semibold text-gray-200"},ze={class:"text-xs text-gray-400"},De={key:0,class:"dropdown dropdown-left"},Ie={tabindex:"0",class:"btn btn-ghost btn-xs md:btn-sm p-1 h-auto min-h-0"},Be={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow-lg bg-dark-800 rounded-lg w-40"},Ne={key:0},Oe={key:1},qe={class:"mt-2"},Le={key:0,class:"text-gray-300 prose prose-invert prose-sm max-w-none"},Je={class:"flex justify-end gap-2"},We={class:"flex items-center gap-3 mt-3"},Xe={key:0,class:"ml-8 md:ml-12 mt-2 space-y-2"},Ye={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Ge={class:"relative bg-dark-700 rounded-xl p-6 max-w-lg w-full"},Ke={key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Qe={class:"relative bg-dark-700 rounded-xl p-6 max-w-lg w-full"},Ze={class:"text-center"},et={class:"mt-6 flex justify-end gap-3"},tt=G({__name:"CommentsSingle",props:{comment:{type:Object,required:!0},keyEditor:{type:String,default:null},isReply:{type:Boolean,default:!1}},emits:["fresh-comments"],setup(R,{emit:U}){const c=K(),s=R;x(!1);let a=x(!1),i=x(!1);p(()=>v.value||m.value||h.value||_.value);const v=p(()=>s.comment.likes_last_hour>5),m=p(()=>s.comment.is_helpful>=10),h=p(()=>s.comment.is_featured),_=p(()=>s.comment.is_highlighted);p(()=>v.value?"hot-frame":m.value?"popular-frame":h.value?"featured-frame":_.value?"highlighted-frame":""),p(()=>v.value?"bg-gradient-to-r from-orange-500/20 via-red-500/20 to-orange-500/20":m.value?"bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-blue-500/20":h.value?"bg-gradient-to-r from-yellow-500/20 via-amber-500/20 to-yellow-500/20":_.value?"bg-gradient-to-r from-green-500/20 via-emerald-500/20 to-green-500/20":""),p(()=>v.value?"bg-red-500/90 text-white":m.value?"bg-purple-500/90 text-white":h.value?"bg-yellow-500/90 text-black":_.value?"bg-green-500/90 text-white":""),p(()=>v.value?"🔥 Hot":m.value?"⭐ Popular":h.value?"👑 Featured":_.value?"📌 Highlighted":"");const j=p(()=>{var y,t,g,S;return((t=(y=$().props.authUserInfo)==null?void 0:y.data)==null?void 0:t.id)===((S=(g=s.comment)==null?void 0:g.user)==null?void 0:S.id)}),V=p(()=>j.value||$().props.guard==="admin"),P=async()=>{if($().props.isUserAuth)try{await M.post(route("mark.helpful",s.comment.id)),w()}catch{c.error("Failed to mark as helpful")}},l=async()=>{if(confirm("Are you sure you want to delete this comment?"))try{await M.delete(route("comment.delete",s.comment.id)),c.success("Comment deleted"),w()}catch{c.error("Failed to delete comment")}},F=async()=>{if(!s.comment.body.trim()){c.error("Comment cannot be empty");return}try{await M.post(route("comment.edit",s.comment.id),{comment:s.comment.body.trim()}),a.value=!1,w()}catch{c.error("Failed to update comment")}},w=()=>{i.value=!1,Z("fresh-comments")},Z=U;let b=x(!1),C=x("");const ee=async()=>{var y,t;if(!C.value.trim()){c.error("Please provide a reason for reporting");return}try{const g=await M.post(route("comment.report",s.comment.id),{reason:C.value.trim()});c.success(g.data.message),b.value=!1,C.value=""}catch(g){(t=(y=g.response)==null?void 0:y.data)!=null&&t.errors?Object.values(g.response.data.errors).forEach(S=>{c.error(S[0])}):c.error("Failed to report comment")}};return(y,t)=>{var g,S,D,I,B,N,O,q,L;return o(),n("article",$e,[e("div",je,[e("div",Ee,[e("div",Fe,[e("div",Me,[e("img",{src:(S=(g=s.comment)==null?void 0:g.user)==null?void 0:S.avatar,alt:(I=(D=s.comment)==null?void 0:D.user)==null?void 0:I.full_name,class:"rounded-full h-full w-full object-cover"},null,8,Ae)]),e("div",Pe," Level "+E(((B=s.comment.user)==null?void 0:B.level)||"1"),1),(O=(N=s.comment)==null?void 0:N.user)!=null&&O.has_subscription?(o(),n("div",Re," Subscriber ")):f("",!0)]),e("div",Ue,[e("div",Ve,[e("div",null,[e("div",He,[e("h3",Te,E((q=s.comment.user)==null?void 0:q.full_name),1),e("time",ze," Posted "+E(s.comment.created_at_diff),1)])]),r($)().props.isUserAuth?(o(),n("div",De,[e("label",Ie,[d(r(me),{class:"w-4 h-4 text-gray-400"})]),e("ul",Be,[j.value?(o(),n("li",Ne,[e("button",{onClick:t[0]||(t[0]=u=>k(a)?a.value=!r(a):a=!r(a)),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-300 hover:bg-dark-600"},[d(r(ue),{class:"w-4 h-4"}),t[8]||(t[8]=J(" Edit "))])])):f("",!0),V.value?(o(),n("li",Oe,[e("button",{onClick:l,class:"flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-dark-600"},[d(r(pe),{class:"w-4 h-4"}),t[9]||(t[9]=J(" Delete "))])])):f("",!0)])])):f("",!0)]),e("div",qe,[r(a)?(o(),n("form",{key:1,onSubmit:H(F,["prevent"]),class:"space-y-2"},[T(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=u=>s.comment.body=u),class:"w-full bg-dark-800 rounded-lg p-3 text-sm text-gray-200 border border-dark-600 focus:border-purple-500 focus:ring-1 focus:ring-purple-500",rows:"3"},null,512),[[z,s.comment.body]]),e("div",Je,[e("button",{type:"button",onClick:t[2]||(t[2]=u=>k(a)?a.value=!1:a=!1),class:"btn btn-ghost btn-xs md:btn-sm"}," Cancel "),t[10]||(t[10]=e("button",{type:"submit",class:"btn btn-primary btn-xs md:btn-sm"}," Update ",-1))])],32)):(o(),n("div",Le,[d(ie,{content:s.comment.body},null,8,["content"])]))]),e("div",We,[r($)().props.guard==="web"?(o(),n("button",{key:0,onClick:P,class:A(["inline-flex items-center gap-1.5 text-sm",s.comment.user_helpful_Comments?"text-purple-400":"text-gray-400"])},[d(r(ce),{class:A([s.comment.user_helpful_Comments?"fill-current":"","w-4 h-4"])},null,8,["class"]),e("span",null,E(s.comment.is_helpful),1)],2)):f("",!0),r($)().props.isUserAuth?(o(),n("button",{key:1,onClick:t[3]||(t[3]=u=>k(i)?i.value=!r(i):i=!r(i)),class:"inline-flex items-center gap-1.5 text-sm text-gray-400"},[d(r(Q),{class:"w-4 h-4"}),t[11]||(t[11]=e("span",{class:"hidden md:inline"},"Reply",-1))])):f("",!0),e("button",{onClick:t[4]||(t[4]=u=>k(b)?b.value=!r(b):b=!r(b)),class:"inline-flex items-center gap-1.5 text-sm text-gray-400"},[d(r(Y),{class:"w-4 h-4"}),t[12]||(t[12]=e("span",{class:"hidden md:inline"},"Report",-1))])])])])]),(L=s.comment.replies)!=null&&L.length?(o(),n("div",Xe,[t[13]||(t[13]=e("div",{class:"absolute left-5 md:left-6 top-16 bottom-0 w-px bg-purple-500/20"},null,-1)),(o(!0),n(se,null,re(s.comment.replies,u=>(o(),W(st,{key:u.id,comment:u,"key-editor":s.keyEditor,"is-reply":!0,onFreshComments:w},null,8,["comment","key-editor"]))),128))])):f("",!0),(o(),W(oe,{to:"body"},[r(i)?(o(),n("div",Ye,[t[14]||(t[14]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",Ge,[d(Se,{"model-class":"comment","model-id":s.comment.id,"key-editor":s.keyEditor,onFreshComments:w,onClose:t[5]||(t[5]=u=>k(i)?i.value=!1:i=!1)},null,8,["model-id","key-editor"])])])):f("",!0),r(b)?(o(),n("div",Ke,[t[17]||(t[17]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",Qe,[e("div",Ze,[d(r(Y),{class:"w-12 h-12 text-yellow-400 mx-auto"}),t[15]||(t[15]=e("h3",{class:"mt-4 text-xl font-medium text-gray-200"},"Report Comment",-1))]),e("form",{onSubmit:H(ee,["prevent"]),class:"mt-6"},[T(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=u=>k(C)?C.value=u:C=u),placeholder:"Please describe why you're reporting this comment...",class:"w-full bg-dark-800 rounded-lg p-4 text-sm text-gray-200 border border-dark-600 focus:border-yellow-500 focus:ring-1 focus:ring-yellow-500",rows:"4"},null,512),[[z,r(C)]]),e("div",et,[e("button",{type:"button",onClick:t[7]||(t[7]=u=>k(b)?b.value=!1:b=!1),class:"btn btn-ghost btn-sm"}," Cancel "),t[16]||(t[16]=e("button",{type:"submit",class:"btn btn-warning btn-sm"}," Submit Report ",-1))])],32)])])):f("",!0)]))])}}}),st=de(tt,[["__scopeId","data-v-d9c21e0c"]]);export{st as S,Se as _};
