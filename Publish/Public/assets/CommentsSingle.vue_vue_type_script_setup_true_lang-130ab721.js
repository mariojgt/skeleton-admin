import{x as P,bO as Q,a as _,o as a,g as d,u as o,Q as w,f as F,d as e,C as V,by as E,i as b,k as Y,v as h,t as A,b as R,s as I,e as f,T as K,F as L,y as W,w as T}from"./preset-e6c2fca6.js";import{a as C}from"./axios-744ab111.js";import{_ as q}from"./ReusableModal-a150f8c1.js";import{_ as v}from"./dynamicIcon.vue_vue_type_script_setup_true_lang-f1dacdc7.js";const X={class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 p-4 border border-gray-700 rounded-lg bg-dark-blue-100 text-white w-2/4"},Z=e("label",{for:"comment",class:"text-xl font-bold"},"Your comment",-1),ee=e("h5",null,"Please Follow the guidelines",-1),te=e("button",{class:"btn btn-secondary mt-2"},"Submit",-1),se=P({__name:"Comment",props:{modelClass:{type:String,default:""},modelId:{type:Number,default:0},keyEditor:{type:String,default:null},commentClass:{type:String,default:"w-full rounded-lg"}},emits:["fresh-comments","close"],setup(S,{emit:j}){const c=Q(),t=S;let i=_(""),r=_("");const p=j,M=async()=>{const g={title:r.value,comment:i.value,model:t.modelClass,model_id:t.modelId};if(i.value===""){c.error("The comment is required");return}await C.post(route("comment.add"),g).then(function(n){c.success(n.data.message)}).catch(function(n){for(const[y,U]of Object.entries(n.response.data.errors))c.error(U[0])}),i.value="",r.value="",p("fresh-comments"),p("close")},m=async()=>{p("close")};return(g,n)=>(a(),d("div",X,[o(w)().props.isUserAuth?(a(),d("form",{key:0,onSubmit:F(M,["prevent"])},[e("div",{class:Y(t.commentClass)},[Z,V(e("textarea",{placeholder:"Comment",class:"textarea textarea-bordered textarea-lg w-full mt-2","onUpdate:modelValue":n[0]||(n[0]=y=>b(i)?i.value=y:i=y)},null,512),[[E,o(i)]]),e("div",{class:"flex justify-between"},[ee,e("div",{class:"mt-2 flex justify-end gap-3"},[e("div",{onClick:m,class:"btn btn-primary mt-2"}," Cancel "),te])])],2)],32)):h("",!0)]))}}),oe={class:"mt-5 bg-primary rounded-lg p-3 shadow-lg hover:bg-dark-400"},ne={class:"flex items-center mb-4 space-x-4"},ae=["src"],le=["src"],re={class:"space-y-1 font-medium text-white"},me={class:"mr-2 block text-lg font-bold text-white"},de=["datetime"],ce=["innerHTML"],ie=e("button",{class:"btn btn-secondary mt-2 w-full"},"Update",-1),ue={class:"flex items-center justify-between mt-4"},fe={class:"flex items-center"},be={class:"text-lg font-bold"},pe={key:0,class:"flex items-center space-x-2"},ye={class:"dropdown dropdown-left"},he={tabindex:"0",class:"btn btn-sm btn-primary m-1"},xe={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52 gap-2"},ve={class:"mt-2"},_e={class:"flex flex-col items-center space-x-2"},we=e("h1",{class:"mt-2 text-xl font-semibold"}," Are you sure? ",-1),ge=e("p",{class:"mt-3 text-lg font-bold"},"If you proceed, your comment (and any replies to it) will be deleted.",-1),ke={class:"flex flex-col w-full gap-2"},Ce=e("header",{class:"text-center md:px-12 text-neutral"},[e("h2",{class:"text-4xl font-semibold"},"Report abuse")],-1),$e=e("button",{type:"submit",class:"btn btn-warning mt-3 w-full rounded-lg text-xl font-bold"}," Report ",-1),Ie=P({__name:"CommentsSingle",props:{comment:{type:Object,default:()=>{}},keyEditor:{type:String,default:null}},emits:["fresh-comments"],setup(S,{emit:j}){const c=Q(),t=S,i=j;let r=_(!1),p=_("");const M=async()=>{r.value=!1,await C.post(route("comment.report",t.comment.id),{reason:p.value}).then(function(u){c.success(u.data.message)}).catch(function(u){for(const[s,k]of Object.entries(u.response.data.errors))c.error(k[0])}),y()};let m=_(!1);const g=async()=>{m.value=!1,await C.delete(route("comment.delete",t.comment.id)).then(function(u){c.success(u.data.message)}),y()};let n=_(!1);const y=async()=>{n.value=!1,i("fresh-comments")},U=async()=>{w().props.isUserAuth&&(await C.post(route("mark.helpful",t.comment.id)).then(function(u){c.success(u.data.message)}),y())};let x=_(!1);const G=async()=>{const u={comment:t.comment.body};if(t.comment.body===""){c.error("The comment is required");return}await C.post(route("comment.edit",t.comment.id),u).then(function(s){c.success(s.data.message)}).catch(function(s){for(const[k,$]of Object.entries(s.response.data.errors))c.error($[0])}),i("fresh-comments"),x.value=!1};return(u,s)=>{var k,$,H,N,O,z,B,D;return a(),d(L,null,[e("article",oe,[e("div",ne,[($=(k=t.comment)==null?void 0:k.user)!=null&&$.avatar?(a(),d("img",{key:0,class:"w-20 h-20 rounded-md",src:t.comment.user.avatar,alt:"User Avatar"},null,8,ae)):h("",!0),(N=(H=t.comment)==null?void 0:H.admin)!=null&&N.avatar?(a(),d("img",{key:1,class:"w-12 h-12 rounded-md",src:t.comment.admin.avatar,alt:"Admin Avatar"},null,8,le)):h("",!0),e("div",re,[e("p",null,[e("a",me,A(t.comment.user.full_name),1),e("time",{datetime:t.comment.created_at_diff,class:"block text-sm text-gray-400"}," Posted "+A(t.comment.created_at_diff),9,de)]),o(x)?h("",!0):(a(),d("div",{key:0,class:"text-gray-200 text-base",innerHTML:t.comment.body},null,8,ce))])]),o(x)?(a(),d("form",{key:0,onSubmit:F(G,["prevent"])},[V(e("textarea",{placeholder:"Comment",class:"textarea textarea-bordered textarea-lg w-full mt-2","onUpdate:modelValue":s[0]||(s[0]=l=>t.comment.body=l)},null,512),[[E,t.comment.body]]),ie],32)):h("",!0),e("div",ue,[e("div",fe,[o(w)().props.guard==="web"?(a(),d("button",{key:0,class:Y(["btn btn-sm btn-primary hover:btn-accent text-white hover:text-black",t.comment.user_helpful_Comments?"btn-secondary":"btn-primary"]),onClick:U},[t.comment.user_helpful_Comments?(a(),R(v,{key:0,componentId:"heartSolid"})):(a(),R(v,{key:1,componentId:"heart"})),e("span",be,A(t.comment.is_helpful),1)],2)):h("",!0)]),o(w)().props.isUserAuth?(a(),d("div",pe,[e("button",{class:"btn btn-sm btn-secondary hover:btn-accent text-white hover:text-black",onClick:s[1]||(s[1]=l=>b(n)?n.value=!o(n):n=!o(n))},[I(" Reply "),f(v,{componentId:"reply"})]),e("div",ye,[e("label",he,[f(v,{componentId:"dots"})]),e("ul",xe,[e("li",null,[e("button",{class:"btn btn-primary hover:btn-secondary text-white hover:text-black btn-sm flex justify-between",onClick:s[2]||(s[2]=l=>b(r)?r.value=!o(r):r=!o(r))},[I(" Report abuse "),f(v,{componentId:"alert",class:"size-6"})])]),e("li",null,[e("button",{onClick:s[3]||(s[3]=l=>b(x)?x.value=!o(x):x=!o(x)),class:"btn btn-secondary btn-sm flex justify-between"},[I(" Edit "),f(v,{componentId:"edit"})])]),e("li",null,[((z=(O=o(w)().props.authUserInfo)==null?void 0:O.data)==null?void 0:z.id)===((D=(B=t.comment)==null?void 0:B.user)==null?void 0:D.id)||o(w)().props.guard==="admin"?(a(),d("button",{key:0,class:"btn btn-error hover:btn-secondary text-white hover:text-black btn-sm flex justify-between",onClick:s[4]||(s[4]=l=>b(m)?m.value=!0:m=!0)},[I(" Delete "),f(v,{componentId:"trash"})])):h("",!0)])])])])):h("",!0)]),o(n)?(a(),R(K,{key:1,to:"body"},[f(se,{"model-class":"comment","comment-class":"w-full","model-id":t.comment.id,"key-editor":t.keyEditor,onFreshComments:y,onClose:s[5]||(s[5]=l=>b(n)?n.value=!1:n=!1)},null,8,["model-id","key-editor"])])):h("",!0)]),(a(!0),d(L,null,W(t.comment.replies,(l,J)=>(a(),d("div",{key:J,class:"ml-10 mt-4"},[f(Ie,{comment:l,"key-editor":t.keyEditor,onFreshComments:y},null,8,["comment","key-editor"])]))),128)),f(o(q),{show:o(m),onClose:s[7]||(s[7]=l=>b(m)?m.value=!1:m=!1),onConfirm:g,modalClass:"bg-dark-100",showHeader:!1,showFooter:!1},{body:T(()=>[e("div",ve,[e("div",_e,[f(v,{componentId:"alert",class:"size-14"}),we,ge,e("div",ke,[e("button",{class:"btn btn-outline btn-secondary",onClick:s[6]||(s[6]=l=>b(m)?m.value=!1:m=!1)}," Cancel "),e("button",{class:"btn btn-secondary",onClick:g}," Delete ")])])])]),_:1},8,["show"]),f(o(q),{show:o(r),onClose:s[9]||(s[9]=l=>b(r)?r.value=!1:r=!1),showHeader:!0,showFooter:!1,modalClass:"bg-primary",isLarge:!0},{title:T(()=>[Ce]),body:T(()=>[e("form",{onSubmit:F(M,["prevent"]),class:"rounded-lg"},[V(e("textarea",{"onUpdate:modelValue":s[8]||(s[8]=l=>b(p)?p.value=l:p=l),placeholder:"Reason",class:"textarea textarea-bordered textarea-lg w-full font-bold mt-2"},null,512),[[E,o(p)]]),$e],32)]),_:1},8,["show"])],64)}}});export{Ie as _,se as a};
