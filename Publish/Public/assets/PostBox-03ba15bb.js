import{y as N,bZ as P,a as v,p as U,o as d,g as m,u as b,Q as j,f as D,d as o,E,G as S,i as x,v as T,H as O,z as L,t as z,x as h,l as A,F,m as R,s as $,b as B,e as q,w as G,$ as H,X as Q}from"./preset-fafa7a54.js";import{a as V}from"./axios-087e9270.js";const W={class:"fixed bottom-0 left-1/2 transform -translate-x-1/2 p-4 border border-gray-700 rounded-lg bg-dark-blue-100 text-white w-2/4"},X=["value"],Y=N({__name:"Post",props:{commentClass:{type:String,default:"w-full rounded-lg"},categories:{type:Array,default:()=>[]},topitEdit:{type:Object,default:()=>{}}},emits:["fresh-comments","close"],setup(g,{emit:w}){const s=P(),r=g;let l=v(""),a=v(""),n=v("");const p=w,u=async()=>{var e,t,i,y;const c={title:a.value,content:l.value,category:n.value};if(a.value===""||l.value===""){s.error("All fields are required");return}try{let f=route("forum.thread.create");(e=r.topitEdit)!=null&&e.id&&(f=route("forum.thread.edit",(t=r.topitEdit)==null?void 0:t.id));const C=await V.post(f,c);s.success(C.data.message),l.value="",a.value="",n.value="",p("fresh-comments"),p("close")}catch(f){(y=(i=f.response)==null?void 0:i.data)!=null&&y.errors&&Object.values(f.response.data.errors).forEach(C=>{s.error(C[0])})}},k=async()=>{var c,e,t;try{const i=await V.delete(route("forum.thread.edit",(c=r.topitEdit)==null?void 0:c.id));s.success(i.data.message),F.visit(route("home"),{preserveScroll:"errors"})}catch(i){console.log(i),(t=(e=i.response)==null?void 0:e.data)!=null&&t.errors&&Object.values(i.response.data.errors).forEach(y=>{s.error(y[0])})}},M=()=>{p("close")};return U(()=>{r.topitEdit&&(l.value=r.topitEdit.content,a.value=r.topitEdit.title)}),(c,e)=>(d(),m("div",W,[b(j)().props.isUserAuth?(d(),m("form",{key:0,onSubmit:D(u,["prevent"])},[o("div",{class:A(r.commentClass)},[e[7]||(e[7]=o("label",{for:"commentTitle",class:"text-xl font-bold"},"Add a Title",-1)),E(o("input",{id:"commentTitle","onUpdate:modelValue":e[0]||(e[0]=t=>x(a)?a.value=t:a=t),type:"text",placeholder:"Enter a title",class:"input input-bordered w-full bg-gray-800 text-white mt-2"},null,512),[[S,b(a)]]),r.topitEdit?h("",!0):(d(),m(T,{key:0},[e[4]||(e[4]=o("label",{for:"channel",class:"text-xl font-bold mb-2"},"Select Topic",-1)),E(o("select",{id:"channel","onUpdate:modelValue":e[1]||(e[1]=t=>x(n)?n.value=t:n=t),class:"select select-bordered w-full bg-gray-800 text-white mt-2"},[e[3]||(e[3]=o("option",{value:""},"Select Channel",-1)),(d(!0),m(T,null,L(g.categories,t=>(d(),m("option",{key:t.id,value:t.slug},z(t.name),9,X))),128))],512),[[O,b(n)]])],64)),e[8]||(e[8]=o("label",{for:"comment",class:"text-xl font-bold mb-2"},"Your Comment",-1)),E(o("textarea",{id:"comment","onUpdate:modelValue":e[2]||(e[2]=t=>x(l)?l.value=t:l=t),placeholder:"Write your comment here...",class:"textarea textarea-bordered w-full h-24 bg-gray-800 text-white mt-2"},null,512),[[S,b(l)]]),o("div",{class:"flex justify-between"},[e[6]||(e[6]=o("h5",{class:"text-sm"},"Please follow the guidelines",-1)),o("div",{class:"mt-2 flex justify-end gap-3"},[o("button",{type:"button",onClick:M,class:"btn btn-primary mt-2"}," Cancel "),o("button",{type:"button",onClick:k,class:"btn btn-primary mt-2"}," Delete "),e[5]||(e[5]=o("button",{type:"submit",class:"btn btn-secondary mt-2"}," Submit ",-1))])])],2)],32)):h("",!0)]))}}),Z={class:"mt-3 bg-dark-100 rounded-lg"},K={__name:"PostBox",props:{categories:{type:Array,default:()=>[]},postBtnClass:{type:String,default:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold py-2 px-4 rounded-lg mb-6"},topitEdit:{type:Object,default:()=>{}}},emits:["displayLogin"],setup(g,{emit:w}){let s=v(!1);const r=g,l=()=>{setTimeout(()=>{F.reload({only:["blogPost"]})},300)},a=w,n=()=>{if(!j().props.isUserAuth){a("displayLogin",!0);return}s.value=!s.value};return(p,u)=>(d(),m("section",Z,[o("button",{class:A(r.postBtnClass),onClick:n},[R(p.$slots,"default",{},()=>[u[1]||(u[1]=$("New Dicussion"))])],2),(d(),B(Q,{to:"body"},[q(H,{name:"fade"},{default:G(()=>[b(s)?(d(),B(Y,{key:0,onFreshComments:l,onClose:u[0]||(u[0]=k=>x(s)?s.value=!1:s=!1),categories:r.categories,topitEdit:r.topitEdit},null,8,["categories","topitEdit"])):h("",!0)]),_:1})]))]))}};export{K as _};
