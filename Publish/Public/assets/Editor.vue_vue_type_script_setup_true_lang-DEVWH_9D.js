import{B as b,q as P,ap as R,a as D,aq as _,k as U,ar as K,as as k,at as N,h as B,a8 as z,o as T,g as q,e as G,u as S,i as H,H as W,A as J}from"./index-DQfThwAa.js";var Q=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],X=function(e){return Q.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},Y=function(e,t,n){Object.keys(t).filter(X).forEach(function(i){var o=t[i];typeof o=="function"&&(i==="onInit"?o(e,n):n.on(i.substring(2),function(u){return o(u,n)}))})},Z=function(e,t,n,i){var o=e.modelEvents?e.modelEvents:null,u=Array.isArray(o)?o.join(" "):o;b(i,function(l,r){n&&typeof l=="string"&&l!==r&&l!==n.getContent({format:e.outputFormat})&&n.setContent(l)}),n.on(u||"change input undo redo",function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))})},$=function(e,t,n,i,o,u){i.setContent(u()),n.attrs["onUpdate:modelValue"]&&Z(t,n,i,o),Y(e,n.attrs,i)},M=0,j=function(e){var t=Date.now(),n=Math.floor(Math.random()*1e9);return M++,e+"_"+n+M+String(t)},ee=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},A=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},ne=function(e,t){return A(e).concat(A(t))},te=function(e){return e==null},I=function(){return{listeners:[],scriptId:j("tiny-script"),scriptLoaded:!1}},ae=function(){var e=I(),t=function(o,u,l,r){var a=u.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=o,a.src=l;var c=function(){a.removeEventListener("load",c),r()};a.addEventListener("load",c),u.head&&u.head.appendChild(a)},n=function(o,u,l){e.scriptLoaded?l():(e.listeners.push(l),o.getElementById(e.scriptId)||t(e.scriptId,o,u,function(){e.listeners.forEach(function(r){return r()}),e.scriptLoaded=!0}))},i=function(){e=I()};return{load:n,reinitialize:i}},oe=ae(),re=function(){return typeof window<"u"?window:global},g=function(){var e=re();return e&&e.tinymce?e.tinymce:null},ie={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},v=function(){return v=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},v.apply(this,arguments)},ue=function(e,t,n,i){return e(i||"div",{id:t,ref:n})},le=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},E={selector:void 0,target:void 0},de=P({props:ie,setup:function(e,t){var n=e.init?v(v({},e.init),E):v({},E),i=R(e),o=i.disabled,u=i.modelValue,l=i.tagName,r=D(null),a=null,c=e.id||j("tiny-vue"),m=e.init&&e.init.inline||e.inline,f=!!t.attrs["onUpdate:modelValue"],y=!0,p=e.initialValue?e.initialValue:"",w="",L=function(d){return f?function(){return u!=null&&u.value?u.value:""}:function(){return d?p:w}},h=function(){var d=L(y),s=v(v({},n),{readonly:e.disabled,target:r.value,plugins:ne(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:m,setup:function(C){a=C,C.on("init",function(F){return $(F,e,t,C,u,d)}),typeof n.setup=="function"&&n.setup(C)}});ee(r.value)&&(r.value.style.visibility=""),g().init(s),y=!1};b(o,function(d){var s;a!==null&&(typeof((s=a.mode)===null||s===void 0?void 0:s.set)=="function"?a.mode.set(d?"readonly":"design"):a.setMode(d?"readonly":"design"))}),b(l,function(d){var s;f||(w=a.getContent()),(s=g())===null||s===void 0||s.remove(a),_(function(){return h()})}),U(function(){if(g()!==null)h();else if(r.value&&r.value.ownerDocument){var d=e.cloudChannel?e.cloudChannel:"6",s=e.apiKey?e.apiKey:"no-api-key",C=te(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(s,"/tinymce/").concat(d,"/tinymce.min.js"):e.tinymceScriptSrc;oe.load(r.value.ownerDocument,C,h)}}),K(function(){g()!==null&&g().remove(a)}),m||(k(function(){y||h()}),N(function(){var d;f||(w=a.getContent()),(d=g())===null||d===void 0||d.remove(a)}));var x=function(d){var s;w=a.getContent(),(s=g())===null||s===void 0||s.remove(a),n=v(v(v({},n),d),E),_(function(){return h()})};return t.expose({rerender:x,getEditor:function(){return a}}),function(){return m?ue(B,c,r,e.tagName):le(B,c,r)}}}),V,O;function se(){return O||(O=1,V=typeof self=="object"?self.FormData:window.FormData),V}var ce=se();const fe=z(ce),me=P({__name:"Editor",props:{modelValue:{type:String,default:""},apiKey:{type:String,default:null},editModelValue:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=t;let o=null;const u=c=>{o=c.editor,o.on("change",m=>{l()})},l=()=>{i("update:modelValue",r.value)};let r=D(null),a=D(!1);return U(()=>{r.value=n.modelValue,a.value=!0}),b(()=>r.value,c=>{a.value&&l()}),b(()=>n.editModelValue,c=>{r.value=c,l()}),(c,m)=>(T(),q("div",null,[G(S(de),{modelValue:S(r),"onUpdate:modelValue":m[0]||(m[0]=f=>H(r)?r.value=f:r=f),"api-key":n.apiKey,init:{plugins:"lists link image table code help wordcount codesample importcss",toolbar:"undo redo | image code | codesample",content_css:"/my-styles.css",setup:f=>u({editor:f}),images_upload_handler:async f=>{let y=new(S(fe));y.append("file",f.blob(),f.filename());try{const p=await S(W).post(S(J)().props.upload_media,y,{headers:{"Content-Type":"multipart/form-data"}});if(p.data&&p.data.data.url.default)return p.data.data.url.default;throw new Error("Unable to upload image")}catch{throw new Error("Unable to upload image")}}}},null,8,["modelValue","api-key","init"])]))}});export{me as _};
